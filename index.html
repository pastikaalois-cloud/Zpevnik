<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="ZpÄvnÃ­k">
<meta name="theme-color" id="theme-color" content="#ff6b00">
<link rel="manifest" href="manifest.json">
<title>ZpÄvnÃ­k</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
:root{
  --bg:#fff;--bg2:#f7f7f7;--bg3:#eeeeee;--border:#e0e0e0;
  --accent:#ff6b00;--accent2:#e05a00;
  --text:#1a1a1a;--text2:#555;--text3:#999;
  --chord-bg:#fff0e6;--chord:#cc4400;
}
body.dark{
  --bg:#111111;--bg2:#1e1e1e;--bg3:#2a2a2a;--border:#333333;
  --accent:#ff6b00;--accent2:#e05a00;
  --text:#d0d0d0;--text2:#999999;--text3:#555555;
  --chord-bg:#2a1e10;--chord:#ff8533;
}
html,body{height:100%;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,sans-serif;overflow:hidden}

/* ââ SCREENS ââ */
.screen{display:none;flex-direction:column;height:100dvh}
.screen.active{display:flex}

/* HOME */
.home-top{display:flex;align-items:center;justify-content:space-between;padding:16px 16px 12px;border-bottom:1.5px solid var(--border);background:var(--bg)}
.logo{font-size:22px;font-weight:800;color:var(--accent)}
.hdr-r{display:flex;gap:8px}
.ibtn{background:var(--bg2);border:1.5px solid var(--border);color:var(--text);border-radius:12px;width:46px;height:46px;font-size:18px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.ibtn:active{background:var(--bg3)}
.add-btn{background:var(--accent);border:none;color:#fff;border-radius:12px;height:46px;padding:0 20px;font-size:15px;font-weight:700;font-family:inherit;cursor:pointer}
.add-btn:active{background:var(--accent2)}
.srch{display:flex;align-items:center;gap:10px;margin:12px 16px 6px;background:var(--bg2);border:1.5px solid var(--border);border-radius:14px;padding:0 14px;height:50px}
.srch:focus-within{border-color:var(--accent)}
.srch input{background:none;border:none;outline:none;color:var(--text);font-family:inherit;font-size:16px;width:100%}
.srch input::placeholder{color:var(--text3)}
.cnt{color:var(--text3);font-size:13px;font-weight:500;padding:2px 16px 8px}
.list{flex:1;overflow-y:auto;padding:0 16px 24px}
.card{display:flex;align-items:center;justify-content:space-between;border:1.5px solid var(--border);border-radius:16px;padding:16px;margin-bottom:10px;cursor:pointer;background:var(--bg)}
.card:active{background:var(--bg2);border-color:var(--accent)}
.card-t{font-size:17px;font-weight:700;margin-bottom:3px}
.card-a{font-size:13px;color:var(--text3)}
.card-r{display:flex;align-items:center;gap:8px}
.kbdg{background:var(--chord-bg);color:var(--chord);border-radius:8px;padding:4px 10px;font-size:13px;font-weight:700;font-family:monospace}
.delbtn{background:none;border:none;color:var(--text3);font-size:20px;width:38px;height:38px;display:flex;align-items:center;justify-content:center;cursor:pointer;border-radius:10px}
.delbtn:active{background:var(--bg3)}
.empty{color:var(--text3);text-align:center;padding:60px 20px;font-size:15px;line-height:1.8}
.card-snippet{font-size:12px;color:var(--text3);margin-top:5px;line-height:1.5;font-style:italic}
.card-snippet mark{background:color-mix(in srgb,var(--accent) 25%,transparent);color:var(--accent);border-radius:3px;padding:0 2px;font-style:normal;font-weight:700}

/* SONG VIEW */
.song-hdr{background:var(--bg);border-bottom:1.5px solid var(--border);flex-shrink:0}
.song-top{display:flex;align-items:center;gap:10px;padding:12px 16px 10px}
.back-btn{background:var(--bg2);border:1.5px solid var(--border);color:var(--text);border-radius:12px;height:48px;padding:0 16px;font-size:15px;font-weight:700;font-family:inherit;cursor:pointer;display:flex;align-items:center;gap:6px;flex-shrink:0}
.back-btn:active{background:var(--bg3)}
.song-info{flex:1;min-width:0}
.song-info h2{font-size:18px;font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.song-info .sub{color:var(--text3);font-size:13px}
.ctrls{display:flex;gap:8px;padding:0 16px 12px;overflow-x:auto}
.cbtn{background:var(--bg2);border:1.5px solid var(--border);color:var(--text2);border-radius:12px;height:44px;padding:0 18px;font-size:14px;font-weight:700;font-family:inherit;cursor:pointer;white-space:nowrap;flex-shrink:0}
.cbtn:active{background:var(--bg3)}
.cbtn.on{border-color:var(--accent);color:var(--accent)}
.song-body{flex:1;overflow-y:auto;padding:18px 18px 6px;-webkit-overflow-scrolling:touch}
.line{display:flex;flex-wrap:wrap;align-items:flex-end;margin-bottom:4px;min-height:1.8em}
.ch{display:inline-block;color:var(--chord);background:var(--chord-bg);font-family:monospace;font-size:.75em;font-weight:800;border-radius:5px;padding:1px 6px;margin-right:2px;align-self:flex-start;line-height:1.7;cursor:pointer}
.lyr{display:inline;line-height:2.6}
.blank{height:12px}
.scbar{display:flex;align-items:center;gap:8px;padding:10px 16px;border-top:1.5px solid var(--border);background:var(--bg);flex-shrink:0}
.scbtn{background:var(--bg2);border:1.5px solid var(--border);color:var(--text);border-radius:12px;height:44px;padding:0 16px;font-size:14px;font-weight:700;font-family:inherit;cursor:pointer;white-space:nowrap}
.scbtn:active{background:var(--bg3)}
.scbtn.on{background:var(--accent);border-color:var(--accent);color:#fff}
.spdbtn{background:var(--bg2);border:1.5px solid var(--border);color:var(--text);border-radius:12px;width:44px;height:44px;font-size:18px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.spdbtn:active{background:var(--bg3)}
.spdlbl{color:var(--text3);font-size:13px;font-weight:700;min-width:26px;text-align:center}

/* ADD / EDIT FORM */
.form-hdr{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1.5px solid var(--border)}
.form-hdr h2{font-size:20px;font-weight:800}
.cancbtn{background:var(--bg2);border:1.5px solid var(--border);color:var(--text2);border-radius:12px;height:46px;padding:0 18px;font-size:15px;font-weight:700;font-family:inherit;cursor:pointer}
.cancbtn:active{background:var(--bg3)}
.fbody{flex:1;overflow-y:auto;padding:16px}
.hint{background:var(--chord-bg);border:1px solid var(--border);border-radius:12px;padding:12px 14px;color:var(--text2);font-size:13px;line-height:1.7;margin-bottom:16px}
.hint code{background:var(--bg);color:var(--chord);font-family:monospace;padding:1px 5px;border-radius:4px}
.fld{margin-bottom:14px}
.fld label{display:block;color:var(--text3);font-size:12px;font-weight:700;margin-bottom:6px;text-transform:uppercase;letter-spacing:.06em}
.inp{width:100%;background:var(--bg2);border:1.5px solid var(--border);border-radius:12px;padding:14px 16px;color:var(--text);font-family:inherit;font-size:16px;outline:none;-webkit-appearance:none}
.inp:focus{border-color:var(--accent)}
.inp::placeholder{color:var(--text3)}
textarea.inp{font-family:monospace;font-size:14px;line-height:1.8;resize:none;min-height:240px}
.ffoot{padding:12px 16px;border-top:1.5px solid var(--border)}
.savebtn{width:100%;background:var(--accent);color:#fff;border:none;border-radius:14px;height:54px;font-size:16px;font-weight:800;font-family:inherit;cursor:pointer}
.savebtn:active{background:var(--accent2)}
::-webkit-scrollbar{width:3px}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}

/* SPLASH */
.splash-bg {
  flex: 1;
  background: linear-gradient(160deg, #ff6b00 0%, #e05000 60%, #c03800 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  position: relative;
}
.splash-bg::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(ellipse at 30% 20%, rgba(255,255,255,0.12) 0%, transparent 60%);
}
.splash-inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0;
  position: relative;
  z-index: 1;
}
.splash-guitar {
  transform-origin: 60px 30px;
  animation: swing 2.8s ease-in-out infinite;
  filter: drop-shadow(0 8px 24px rgba(0,0,0,0.35));
  margin-bottom: 24px;
}
@keyframes swing {
  0%   { transform: rotate(-8deg); }
  50%  { transform: rotate(8deg); }
  100% { transform: rotate(-8deg); }
}
.splash-title {
  font-size: 42px;
  font-weight: 900;
  color: #fff;
  letter-spacing: -1px;
  text-shadow: 0 2px 12px rgba(0,0,0,0.2);
  margin-bottom: 6px;
}
.splash-sub {
  font-size: 16px;
  color: rgba(255,255,255,0.75);
  font-weight: 500;
  margin-bottom: 36px;
}
.splash-btn {
  background: rgba(255,255,255,0.18);
  border: 2px solid rgba(255,255,255,0.7);
  color: #fff;
  border-radius: 16px;
  height: 54px;
  padding: 0 36px;
  font-size: 18px;
  font-weight: 800;
  font-family: inherit;
  cursor: pointer;
  backdrop-filter: blur(4px);
}
.splash-btn:active { background: rgba(255,255,255,0.28); }

/* ADMIN LOGIN MODAL */
.admin-overlay {
  display: none; position: fixed; inset: 0;
  background: rgba(0,0,0,0.55); z-index: 200;
  align-items: center; justify-content: center;
}
.admin-overlay.open { display: flex; }
.admin-modal {
  background: var(--bg); border: 1.5px solid var(--border);
  border-radius: 20px; padding: 28px 24px 24px;
  width: 88%; max-width: 340px;
  box-shadow: 0 8px 40px rgba(0,0,0,0.25);
}
.admin-modal h3 { font-size: 20px; font-weight: 800; margin-bottom: 6px; }
.admin-modal p { color: var(--text3); font-size: 13px; margin-bottom: 18px; }
.admin-modal .inp { margin-bottom: 14px; }
.admin-modal-btns { display: flex; gap: 10px; }
.admin-modal-btns .savebtn { flex: 1; height: 48px; }
.admin-modal-btns .cancbtn { height: 48px; }
.admin-badge {
  background: var(--accent); color: #fff;
  border-radius: 8px; font-size: 11px; font-weight: 800;
  padding: 2px 8px; margin-left: 8px; vertical-align: middle;
  letter-spacing: .04em;
}
/* GITHUB UPDATE MODAL */
.gh-overlay {
  display: none; position: fixed; inset: 0;
  background: rgba(0,0,0,0.55); z-index: 200;
  align-items: center; justify-content: center;
}
.gh-overlay.open { display: flex; }
.gh-modal {
  background: var(--bg); border: 1.5px solid var(--border);
  border-radius: 20px; padding: 28px 24px 24px;
  width: 88%; max-width: 360px;
  box-shadow: 0 8px 40px rgba(0,0,0,0.25);
}
.gh-modal h3 { font-size: 20px; font-weight: 800; margin-bottom: 8px; }
.gh-modal p { color: var(--text2); font-size: 14px; line-height: 1.6; margin-bottom: 18px; }
.gh-modal .savebtn { width: 100%; height: 52px; font-size: 16px; margin-bottom: 10px; }
.gh-modal .cancbtn { width: 100%; height: 44px; }
.gh-status { font-size: 13px; color: var(--text3); text-align: center; margin-top: 12px; min-height: 20px; }
.gh-status.ok { color: #22a84a; font-weight: 700; }
.gh-status.err { color: #e05a00; font-weight: 700; }
.logo-clickable { cursor: pointer; user-select: none; }
.logo-clickable:active { opacity: 0.7; }
</style>
</head>
<body>

<!-- SPLASH -->
<div class="screen active" id="screen-splash">
  <div class="splash-bg">
    <div class="splash-inner">
      <div class="splash-guitar" id="splash-guitar">
        <svg viewBox="0 0 120 260" xmlns="http://www.w3.org/2000/svg" width="120" height="260">
          <!-- Strap -->
          <path d="M58 8 Q20 40 18 130 Q16 200 52 240" stroke="rgba(255,255,255,0.35)" stroke-width="5" fill="none" stroke-linecap="round"/>
          <!-- Neck -->
          <rect x="52" y="8" width="16" height="110" rx="7" fill="#c8860a"/>
          <!-- Frets -->
          <line x1="52" y1="35" x2="68" y2="35" stroke="rgba(255,255,255,0.5)" stroke-width="1.5"/>
          <line x1="52" y1="52" x2="68" y2="52" stroke="rgba(255,255,255,0.5)" stroke-width="1.5"/>
          <line x1="52" y1="69" x2="68" y2="69" stroke="rgba(255,255,255,0.5)" stroke-width="1.5"/>
          <line x1="52" y1="86" x2="68" y2="86" stroke="rgba(255,255,255,0.5)" stroke-width="1.5"/>
          <line x1="52" y1="103" x2="68" y2="103" stroke="rgba(255,255,255,0.5)" stroke-width="1.5"/>
          <!-- Nut -->
          <rect x="50" y="110" width="20" height="5" rx="2" fill="rgba(255,255,255,0.7)"/>
          <!-- Body upper bout -->
          <ellipse cx="60" cy="148" rx="36" ry="28" fill="#d4880c"/>
          <!-- Body waist -->
          <rect x="36" y="160" width="48" height="20" rx="4" fill="#d4880c"/>
          <!-- Body lower bout -->
          <ellipse cx="60" cy="200" rx="42" ry="36" fill="#d4880c"/>
          <!-- Body shading -->
          <ellipse cx="60" cy="200" rx="42" ry="36" fill="rgba(0,0,0,0.08)"/>
          <ellipse cx="50" cy="192" rx="22" ry="20" fill="rgba(255,255,255,0.06)"/>
          <!-- Sound hole -->
          <circle cx="60" cy="175" r="14" fill="rgba(0,0,0,0.45)"/>
          <circle cx="60" cy="175" r="14" fill="none" stroke="rgba(255,255,255,0.25)" stroke-width="2"/>
          <circle cx="60" cy="175" r="10" fill="none" stroke="rgba(255,255,255,0.12)" stroke-width="1"/>
          <!-- Strings -->
          <line x1="54" y1="14" x2="53" y2="185" stroke="rgba(255,255,255,0.55)" stroke-width="0.8"/>
          <line x1="57" y1="14" x2="56" y2="185" stroke="rgba(255,255,255,0.55)" stroke-width="0.8"/>
          <line x1="60" y1="14" x2="60" y2="185" stroke="rgba(255,255,255,0.55)" stroke-width="0.9"/>
          <line x1="63" y1="14" x2="64" y2="185" stroke="rgba(255,255,255,0.55)" stroke-width="0.8"/>
          <line x1="66" y1="14" x2="67" y2="185" stroke="rgba(255,255,255,0.55)" stroke-width="0.8"/>
          <line x1="69" y1="14" x2="70" y2="185" stroke="rgba(255,255,255,0.55)" stroke-width="1.1"/>
          <!-- Bridge -->
          <rect x="44" y="218" width="32" height="7" rx="3" fill="#a06208"/>
          <!-- Tuning pegs -->
          <circle cx="48" cy="14" r="4" fill="#a06208"/>
          <circle cx="53" cy="10" r="4" fill="#a06208"/>
          <circle cx="58" cy="8"  r="4" fill="#a06208"/>
          <circle cx="72" cy="14" r="4" fill="#a06208"/>
          <circle cx="67" cy="10" r="4" fill="#a06208"/>
          <circle cx="62" cy="8"  r="4" fill="#a06208"/>
          <!-- Headstock shape -->
          <rect x="46" y="6" width="28" height="18" rx="6" fill="#c8860a"/>
          <rect x="46" y="6" width="28" height="18" rx="6" fill="rgba(0,0,0,0.12)"/>
          <!-- Tuning pegs on headstock -->
          <circle cx="50" cy="10" r="3" fill="#8a5200"/>
          <circle cx="50" cy="20" r="3" fill="#8a5200"/>
          <circle cx="60" cy="8"  r="3" fill="#8a5200"/>
          <circle cx="60" cy="22" r="3" fill="#8a5200"/>
          <circle cx="70" cy="10" r="3" fill="#8a5200"/>
          <circle cx="70" cy="20" r="3" fill="#8a5200"/>
        </svg>
      </div>
      <div class="splash-title">ZpÄvnÃ­k</div>
      <div class="splash-sub">OtevÅi a zahraj</div>
      <button class="splash-btn" onclick="enterApp()">Vstoupit â</button>
    </div>
  </div>
</div>

<!-- HOME -->
<div class="screen" id="screen-home">
  <div class="home-top">
    <div class="logo logo-clickable" onclick="logoClick()" title="Admin pÅihlÃ¡Å¡enÃ­">âª ZpÄvnÃ­k<span class="admin-badge" id="admin-badge" style="display:none">ADMIN</span></div>
    <div class="hdr-r">
      <button class="ibtn" id="theme-btn" onclick="toggleTheme()">ð</button>
      <button class="add-btn" id="add-btn" onclick="showAdd()" style="display:none">+ PÅidat</button>
      <button class="add-btn" id="update-btn" onclick="showGithubUpdate()" style="display:none;background:#333;border:none;margin-left:4px">âï¸ UloÅ¾it</button>
    </div>
  </div>
  <div class="srch">
    <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
    <input id="srch-inp" type="search" placeholder="Hledat nÃ¡zev, interpret, textâ¦" oninput="renderList()" autocomplete="off">
  </div>
  <div class="cnt" id="cnt"></div>
  <div class="list" id="list"></div>
  <button class="nl-fab" onclick="openNL()" title="NÃ¡pojovÃ½ lÃ­stek">ðº</button>
</div>

<!-- SONG -->
<div class="screen" id="screen-song">
  <div class="song-hdr">
    <div class="song-top">
      <button class="back-btn" onclick="showHome()">
        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
        ZpÄt
      </button>
      <div class="song-info">
        <h2 id="v-title"></h2>
        <div class="sub" id="v-artist"></div>
      </div>
    </div>
    <div class="ctrls">
      <button class="cbtn" onclick="changeFontSize(-2)">Aâ</button>
      <button class="cbtn" onclick="changeFontSize(2)">A+</button>
      <button class="cbtn on" id="chord-btn" onclick="toggleChords()">Akordy â</button>
      <button class="cbtn" id="edit-btn" onclick="showEdit()" style="display:none">âï¸ Upravit</button>
      <button class="cbtn" onclick="transposeAll(-1)">â­ â1</button>
      <button class="cbtn" onclick="transposeAll(1)">â¯ +1</button>
    </div>
  </div>
  <div class="song-body" id="song-body"></div>
  <div class="scbar">
    <button class="scbtn" id="sc-toggle" onclick="toggleScroll()">â¶ Scroll</button>
    <button class="spdbtn" onclick="changeSpeed(-1)">â</button>
    <span class="spdlbl" id="spdlbl">Ã1</span>
    <button class="spdbtn" onclick="changeSpeed(1)">+</button>
  </div>
</div>

<!-- ADD -->
<div class="screen" id="screen-add">
  <div class="form-hdr">
    <h2>PÅidat pÃ­seÅ</h2>
    <button class="cancbtn" onclick="showHome()">ZruÅ¡it</button>
  </div>
  <div class="fbody">
    <div class="hint">Akordy piÅ¡ pÅÃ­mo v textu do hranatÃ½ch zÃ¡vorek:<br><code>[Am]Text pÃ­snÄ [F]pokraÄovÃ¡nÃ­</code></div>
    <div class="fld"><label>NÃ¡zev *</label><input class="inp" id="f-title" type="text" placeholder="NÃ¡zev pÃ­snÄ"></div>
    <div class="fld"><label>Interpret</label><input class="inp" id="f-artist" type="text" placeholder="JmÃ©no interpreta"></div>
    <div class="fld"><label>TÃ³nina</label><input class="inp" id="f-key" type="text" placeholder="G, Am, Câ¦" style="max-width:120px"></div>
    <div class="fld"><label>Text s akordy *</label><textarea class="inp" id="f-content" placeholder="[G]KdyÅ¾ se s vinem probouzÃ­ denâ¦"></textarea></div>
  </div>
  <div class="ffoot"><button class="savebtn" onclick="saveSong()">UloÅ¾it pÃ­seÅ</button></div>
</div>

<!-- EDIT SONG (same structure as ADD) -->
<div class="screen" id="screen-edit">
  <div class="form-hdr">
    <h2>Upravit pÃ­seÅ</h2>
    <button class="cancbtn" onclick="cancelEdit()">ZruÅ¡it</button>
  </div>
  <div class="fbody">
    <div class="hint">Akordy piÅ¡ pÅÃ­mo v textu do hranatÃ½ch zÃ¡vorek:<br><code>[Am]Text pÃ­snÄ [F]pokraÄovÃ¡nÃ­</code><br><br>
    <strong>PÅesun akordu:</strong> klikni na akord v nÃ¡hledu â pak â â posunout</div>
    <div class="fld"><label>NÃ¡zev *</label><input class="inp" id="e-title" type="text"></div>
    <div class="fld"><label>Interpret</label><input class="inp" id="e-artist" type="text"></div>
    <div class="fld"><label>TÃ³nina</label><input class="inp" id="e-key" type="text" style="max-width:120px"></div>
    <div class="fld"><label>Text s akordy *</label><textarea class="inp" id="e-content"></textarea></div>
  </div>
  <div class="ffoot"><button class="savebtn" onclick="saveEdit()">UloÅ¾it zmÄny</button></div>
</div>

<!-- NAPOJOVY LISTEK -->
<div class="nl-overlay" id="nl-overlay" onclick="closeNL()"></div>
<div class="nl-panel" id="nl-panel">
  <div class="nl-hdr">
    <span class="nl-title">ðº NÃ¡pojovÃ½ lÃ­stek</span>
    <div style="display:flex;gap:8px">
      <button class="nl-addbtn" onclick="showAddDrink()">+ NÃ¡poj</button>
      <button class="nl-closebtn" onclick="closeNL()">â</button>
    </div>
  </div>
  <div class="nl-body" id="nl-body"></div>
  <div class="nl-footer">
    <div id="nl-total" style="text-align:center;font-size:15px;font-weight:700;color:var(--accent);padding:6px 0 10px;display:none"></div>
    <button class="nl-resetbtn" onclick="resetAll()">Vynulovat vÅ¡e</button>
  </div>
</div>

<!-- ADMIN LOGIN MODAL -->
<div class="admin-overlay" id="admin-overlay" onclick="closeAdminModal()"></div>
<div class="admin-overlay" id="admin-modal-wrap" style="display:none">
  <div class="admin-modal" onclick="event.stopPropagation()">
    <h3>ð Admin pÅihlÃ¡Å¡enÃ­</h3>
    <p>Zadej heslo pro pÅÃ­stup k admin funkcÃ­m.</p>
    <input class="inp" id="admin-pwd" type="password" placeholder="Hesloâ¦" autocomplete="off">
    <div class="admin-modal-btns">
      <button class="savebtn" onclick="doAdminLogin()">PÅihlÃ¡sit</button>
      <button class="cancbtn" onclick="closeAdminModal()">ZruÅ¡it</button>
    </div>
    <div id="admin-err" style="color:#e05a00;font-size:13px;margin-top:10px;text-align:center;min-height:18px"></div>
  </div>
</div>

<!-- GITHUB UPDATE MODAL -->
<div class="gh-overlay" id="gh-overlay" onclick="closeGhModal()"></div>
<div class="gh-overlay" id="gh-modal-wrap" style="display:none">
  <div class="gh-modal" onclick="event.stopPropagation()">
    <h3>âï¸ Aktualizovat zpÄvnÃ­k</h3>
    <p>Tato akce uloÅ¾Ã­ aktuÃ¡lnÃ­ seznam pÃ­snÃ­ na GitHub. Po ~1â2 minutÃ¡ch uvidÃ­ zmÄny vÅ¡ichni uÅ¾ivatelÃ©.</p>
    <input class="inp" id="gh-token-inp" type="password" placeholder="GitHub token (ghp_...)" autocomplete="off" style="margin-bottom:12px">
    <button class="savebtn" id="gh-confirm-btn" onclick="doGithubUpdate()">UloÅ¾it na GitHub</button>
    <button class="cancbtn" onclick="closeGhModal()">ZruÅ¡it</button>
    <div class="gh-status" id="gh-status"></div>
  </div>
</div>

<!-- ADD DRINK MODAL -->
<div class="modal-overlay" id="drink-overlay" onclick="closeDrinkModal()"></div>
<div class="modal" id="drink-modal">
  <div class="modal-hdr"><strong>PÅidat nÃ¡poj</strong></div>
  <div class="quick-grid">
    <button class="qbtn" onclick="quickDrink('Pivo velkÃ© 12Â°')">ðº VelkÃ© 12Â°</button>
    <button class="qbtn" onclick="quickDrink('Pivo malÃ© 12Â°')">ðº MalÃ© 12Â°</button>
    <button class="qbtn" onclick="quickDrink('Pivo velkÃ© 11Â°')">ðº VelkÃ© 11Â°</button>
    <button class="qbtn" onclick="quickDrink('Pivo malÃ© 11Â°')">ðº MalÃ© 11Â°</button>
    <button class="qbtn" onclick="quickDrink('Pivo velkÃ© 10Â°')">ðº VelkÃ© 10Â°</button>
    <button class="qbtn" onclick="quickDrink('Pivo malÃ© 10Â°')">ðº MalÃ© 10Â°</button>
    <button class="qbtn" onclick="quickDrink('VÃ­no bÃ­lÃ©')">ð¥ VÃ­no bÃ­lÃ©</button>
    <button class="qbtn" onclick="quickDrink('VÃ­no ÄervenÃ©')">ð· VÃ­no ÄervenÃ©</button>
    <button class="qbtn" onclick="quickDrink('Slivovice malÃ¡')">ð¥ Slivka malÃ¡</button>
    <button class="qbtn" onclick="quickDrink('Slivovice velkÃ¡')">ð¥ Slivka velkÃ¡</button>
  </div>
  <div class="modal-divider" id="modal-divider-or">nebo vlastnÃ­</div>
  <input class="inp" id="drink-inp" type="text" placeholder="NÃ¡zev nÃ¡pojeâ¦" style="margin-bottom:8px">
  <input class="inp" id="drink-price" type="number" min="0" step="1" placeholder="Cena (KÄ) â nepovinnÃ©" style="margin-bottom:12px">
  <div style="display:flex;gap:8px">
    <button class="savebtn" style="flex:1" onclick="addDrink()">PÅidat</button>
    <button class="cancbtn" onclick="closeDrinkModal()">ZruÅ¡it</button>
  </div>
</div>

<style>
/* NEW STYLES for edit, napojovy listek, modal */

/* Edit screen - reuse form styles, just need edit-specific */
#screen-edit .fbody { padding-bottom: 0; }

/* NAPOJOVY LISTEK */
.nl-overlay {
  display: none;
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.4);
  z-index: 100;
}
.nl-overlay.open { display: block; }
.nl-panel {
  position: fixed;
  right: -340px;
  top: 0; bottom: 0;
  width: 320px;
  max-width: 90vw;
  background: var(--bg);
  border-left: 1.5px solid var(--border);
  z-index: 101;
  display: flex;
  flex-direction: column;
  transition: right 0.28s cubic-bezier(.4,0,.2,1);
  box-shadow: -4px 0 24px rgba(0,0,0,0.15);
}
.nl-panel.open { right: 0; }
.nl-hdr {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px;
  border-bottom: 1.5px solid var(--border);
  flex-shrink: 0;
}
.nl-title { font-size: 17px; font-weight: 800; }
.nl-addbtn {
  background: var(--accent); border: none; color: #fff;
  border-radius: 10px; height: 38px; padding: 0 14px;
  font-size: 14px; font-weight: 700; font-family: inherit; cursor: pointer;
}
.nl-addbtn:active { background: var(--accent2); }
.nl-closebtn {
  background: var(--bg2); border: 1.5px solid var(--border);
  color: var(--text2); border-radius: 10px;
  width: 38px; height: 38px; font-size: 16px;
  cursor: pointer; display: flex; align-items: center; justify-content: center;
}
.nl-closebtn:active { background: var(--bg3); }
.nl-body { flex: 1; overflow-y: auto; padding: 12px; }
.nl-item {
  display: flex;
  align-items: center;
  background: var(--bg2);
  border: 1.5px solid var(--border);
  border-radius: 14px;
  padding: 12px 14px;
  margin-bottom: 10px;
}
.nl-item-name { flex: 1; font-size: 15px; font-weight: 600; }
.nl-count {
  font-size: 22px; font-weight: 800;
  color: var(--accent);
  min-width: 32px; text-align: center;
  margin: 0 8px;
}
.nl-tally {
  font-size: 13px; color: var(--text3);
  font-family: monospace; letter-spacing: 2px;
  min-width: 60px;
}
.nl-btn {
  background: var(--bg); border: 1.5px solid var(--border);
  color: var(--text); border-radius: 10px;
  width: 40px; height: 40px; font-size: 20px; font-weight: 700;
  cursor: pointer; display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
}
.nl-btn:active { background: var(--bg3); }
.nl-btn.plus { border-color: var(--accent); color: var(--accent); }
.nl-delbtn {
  background: none; border: none; color: var(--text3);
  font-size: 16px; cursor: pointer; padding: 4px 6px;
  border-radius: 8px; margin-left: 4px;
}
.nl-delbtn:active { background: var(--bg3); }
.nl-footer {
  padding: 12px 16px;
  border-top: 1.5px solid var(--border);
  flex-shrink: 0;
}
.nl-resetbtn {
  width: 100%; background: var(--bg2); border: 1.5px solid var(--border);
  color: var(--text2); border-radius: 12px; height: 44px;
  font-size: 14px; font-weight: 700; font-family: inherit; cursor: pointer;
}
.nl-resetbtn:active { background: var(--bg3); }
.nl-empty { color: var(--text3); text-align: center; padding: 40px 20px; font-size: 14px; }
.nl-time { font-size: 11px; color: var(--accent); font-weight: 600; margin-top: 1px; margin-bottom: 2px; }

/* Quick drink select */
.quick-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 7px;
  margin-bottom: 14px;
}
.qbtn {
  background: var(--bg2);
  border: 1.5px solid var(--border);
  color: var(--text);
  border-radius: 11px;
  padding: 10px 8px;
  font-size: 13px;
  font-weight: 600;
  font-family: inherit;
  cursor: pointer;
  text-align: left;
  line-height: 1.2;
}
.qbtn:active { background: var(--bg3); border-color: var(--accent); }
.modal-divider {
  text-align: center;
  color: var(--text3);
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: .06em;
  margin-bottom: 10px;
  position: relative;
}
.modal-divider::before, .modal-divider::after {
  content: '';
  position: absolute;
  top: 50%;
  width: 30%;
  height: 1px;
  background: var(--border);
}
.modal-divider::before { left: 0; }
.modal-divider::after { right: 0; }

/* MODAL */
.modal-overlay {
  display: none; position: fixed; inset: 0;
  background: rgba(0,0,0,0.5); z-index: 200;
}
.modal-overlay.open { display: block; }
.modal {
  display: none; position: fixed;
  left: 50%; top: 50%; transform: translate(-50%,-50%);
  background: var(--bg); border: 1.5px solid var(--border);
  border-radius: 20px; padding: 20px;
  width: min(360px, 92vw);
  max-height: 85dvh;
  overflow-y: auto;
  z-index: 201;
  box-shadow: 0 8px 40px rgba(0,0,0,0.2);
}
.modal.open { display: block; }
.modal-hdr { margin-bottom: 14px; font-size: 16px; }

/* CHORD EDIT */
.ch.selected { background: var(--accent); color: #fff; }
.ch-wrap {
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  vertical-align: bottom;
  position: relative;
}
.ch-move-bar {
  display: none;
  position: absolute;
  bottom: calc(100% + 4px);
  left: 50%;
  transform: translateX(-50%);
  background: var(--bg);
  border: 1.5px solid var(--accent);
  border-radius: 10px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.18);
  z-index: 20;
  flex-direction: row;
  align-items: center;
  overflow: hidden;
}
.ch-wrap.selected .ch-move-bar { display: flex; }
.ch-mv-btn {
  background: none; border: none; color: var(--accent);
  font-size: 16px; font-weight: 800;
  width: 36px; height: 34px;
  cursor: pointer; display: flex; align-items: center; justify-content: center;
  font-family: inherit; flex-shrink: 0;
}
.ch-mv-btn:active { background: var(--chord-bg); }

/* NL floating button */
.nl-fab {
  position: fixed; bottom: 24px; right: 20px;
  background: var(--accent); color: #fff;
  border: none; border-radius: 50%;
  width: 56px; height: 56px; font-size: 22px;
  cursor: pointer; box-shadow: 0 4px 16px rgba(0,0,0,0.2);
  display: flex; align-items: center; justify-content: center;
  z-index: 50;
}
.nl-fab:active { background: var(--accent2); }
</style>
<!-- DEFAULTS: only used on first install to seed localStorage. After that ignored. -->
<script id="defaults-data">
const DEFAULTS = [
  {
    "id": 1771577498254,
    "title": "test",
    "artist": "",
    "key": "",
    "content": "[G]          [D]        [Ami]       [C]\n1. Nad stádem koní  í-í-í, podkovy zvoní, zvoní\n   Černý vůz vlečou-o-o-ou a slzy tečou a já volám"
  },
  {
    "id": 1,
    "title": "Nad stádem koní",
    "artist": "",
    "key": "D",
    "content": "[D]Nad stádem koní í-í-í, [A]podkovy zvoní, [Emi]zvoní [G]\nČerný vůz vlečou a slzy tečou a já volám\n[D]Tak neplač mů-ůj kamaráde, [A]náhoda je blbec, [Emi]když krade [G]\nJe tuhý jak veka a řeka ho splaví, máme ho rádi\n\n[C]No tak co, [G]tak co, [A]tak co\n\n[D]Vždycky si přál, až bude popel, [A]i s kytarou [Emi] [G]\nVodou ať plavou, jen žádný hotel, s křížkem nad hlavou\n[D]Az najdes misto, kde je ten pramen a kamen co praska [A] [Emi] [G]\nBudeš mít jisto, patří sem popel a každá láska\n\nRef: No tak co, tak co, tak co.\n\n[D]Vysyp ten popel kamaráde, [A]do bílé vody, vody, [G] [D] [A] [G]\n[D]vyhasnul kotel a náhoda je, [A]štěstí od podkovy. [Emi] [G]\n\nVysyp ten... 3x"
  },
  {
    "id": 2,
    "title": "Rána v trávě",
    "artist": "",
    "key": "Am",
    "content": "capo 3\n\n[Ami]Každý ráno boty zouval, [G]orosil si nohy v trávě,\nže se lidi mají rádi doufal a procitli právě.\n[Ami]Každý ráno dlouze zíval, [G]utřel čelo do rukávu,\na při chůzi tělem sem tam kýval, před sebou sta sáhů.\n\n[C]Poznal Moravěnku krásnou [G]a vínečko ze zlata,\nv Čechách slávu muzikantů, umazanou od bláta.\n\nRef: Každý ráno boty zouval...\n\n[C]Toužil najít studánečku, [G]a do ní se podívat,\nby mu řekla: proč holečku, musíš světem chodívat.\n\n[C]Studánečka promluvila: [G]to ses' musel nachodit,\nabych já ti pravdu řekla, měl ses' jindy narodit.\n\n[Ami]před sebou sta sáhů, [Emi]před sebou sta sáhů."
  },
  {
    "id": 3,
    "title": "Stánky",
    "artist": "",
    "key": "D",
    "content": "[D]U stánků na levnou krásu, [G]\npostávaj a smějou se času [D] [Gmi]\ns cigaretou a s holkou, co nemá kam jít. [D] [A7] [D]\n\n[G]Skleniček pár a pár tahů z trávy, [D] [Gmi]\nuteče den jak večerní zprávy.\nNeuměj žít a bouřej se a neposlouchaj.\n\nRef. [G]Jen zahlídli svět, maj na duši vrasky. [A7]\n[D]Tak málo je, [Gmi]málo je lásky.\n[D]Ztracená víra hrozny z vinic neposbírá. [A7] [D]\n\nRef. 2x"
  },
  {
    "id": 4,
    "title": "Nejlíp jim bylo",
    "artist": "",
    "key": "C",
    "content": "[C]Nejlip jim bylo [Fmaj7] [C]\nkdyž nevěděli co dělaj' [Fmaj7] [C] [Fmaj7]\njenom se potkali [G]\na neznélo to špatně. [F] [C]\n\n[C]Tak se snažili [Fmaj7] [C]\na opravdu si užívali [Fmaj7] [C] [Fmaj7]\njenom existovali [G]\na čas běžel skvěle. [F] [C]\n\nRef. [F]Nechám si projít hlavou, [C]\n[G]kam všechny věci plavou. [Ami]\n[F]jestli je všechno jen dech, [C]\n[G]tak jako kdysi v noci [Ami] [C] [Fmaj7]\nspolupotmě na schodech.\n\nRef 2x"
  },
  {
    "id": 5,
    "title": "Do nebe",
    "artist": "",
    "key": "G",
    "content": "[G]Haló pane, vy s výhledem na celej svět, [D] [Emi] [C]\nco se stane, když neumim dát odpověď?\nSnad se nezlobíte, snad mi to odpustíte, vždyť víte… že chci\n\nRef. [G]Do nebe, do nebe, do nebe, [D]\n[Emi]do nebe, do nebe, do nebe, [C]\n[G]do nebe, do nebe, do nebe, [D]\n[Emi]do nebezpečna [C]\n\n[G]Haló pane, nad střechami paneláků, [D] [Emi] [C]\naž déšt ustane, až uschnou křídla ptáků.\nBudu relativně šťastný, budu žádaný a krásný,\nbudu obdivován v očích půvabných dam, ale sám… pudu\n\nRefrén 2x\n\n[C]Jsi moja věčná, půvabná slečna! [G]"
  },
  {
    "id": 6,
    "title": "Každej už to ví",
    "artist": "",
    "key": "Em",
    "content": "[Emi]Každej už to ví, [C]už je to napsaný na [D]zdí\nŽe ty a já jsme dva, stejný blázní,\n\n[Emi]Teď máme svátej klid a [C]svět je jako by krásnej, [D]\nMužem klidně žit, já to vím,\n\n[G]Nanananannnananannannananna 2x [D] [Emi] [C] [G] [D] [Emi]\n\n[Emi]Za plotem žiju dál, [C]na zahradě si snídám [D]\nA jak tak vzpomínám, čím dál víc si zpívám\n\n[G]Na tuhle ženu nezapomenu, to ti přisahám. [D] [Emi] [C]\n[G]Co na tom sejde, stejně to nejde – dávno tě pod kůží mám [D] [Emi] [C]\n\n[G]Na tuhle ženu, nezapomenu, v mi hlavě místo má, [D] [Emi] [C]\n[G]Co na tom sejde, když se tam vejde, já jí to nevyčítám. [D] [Emi] [C]"
  },
  {
    "id": 7,
    "title": "Hruška",
    "artist": "",
    "key": "D",
    "content": "[D]Stojí hruška v širém poli vršek se jí zelená [A] [D] [G] [A]\npod ní se pase kůň vraný pase ho má milá\n\n[A]Proč má milá dnes pasete z večera do rána [D] [A] [D] [G] [A]\nkam můj milý pojedete já pojedu s váma\n\n[A]Ó já pojedu daleko přes vody hluboké [D] [A] [D] [G] [A]\nkéž bych byl nikdy nepoznal panny černooké"
  },
  {
    "id": 8,
    "title": "Tisíc mil",
    "artist": "",
    "key": "G",
    "content": "[G]V nohách mám už tisíc mil [Em]\n[Am]stopy déšt a vítr smyl [C]\n[Am]a můj kůň i já jsme cestou znavení. [D7] [G]\n\n[G]Těch tisíc mil těch tisíc mil [Em]\n[Am]má jeden směr a jeden cíl [C]\n[Am]bílej dům to malý bílý stavení. [D7] [G]\n\n[G]Je tam stráň a příkrej sráz [Em]\nmodrá tůň a bobří hráz [Am] [C]\n[Am]táta s mámou kteří věřej dětskejm snům. [D7] [G]\n\n[G]Těch tisíc mil těch tisíc mil [Em]\n[Am]má jeden směr a jeden cíl, [C]\n[Am]jeden cíl ten starej známej bílej dům. [D7] [G]\n\n[G]Kousek dál a já to vím [Em]\nuvidím už stoupat dým [Am] [C]\n[Am]šikmej štít střechy čnít k nebesům. [D7] [G]\n\n[G]Těch tisíc mil těch tisíc mil [Em]\n[Am]má jeden směr a jeden cíl [C]\n[Am]bílej dům to malý bílý stavení. [D7] [G]"
  },
  {
    "id": 9,
    "title": "Růže z papíru",
    "artist": "",
    "key": "Dm",
    "content": "3. cappo\n\n[Dmi]Do tvých očí jsem se zbláznil a teď nemám, nemám klid, [E7] [Gmi]\n[Ami]hlava třeští, asi tě mám rád,\nstále někdo říká: vzbuď se, věčně trhá nit,\n[Ami]studenou sprchu měl bych si dát. [Dmi]\n\n[D7]Na pouti jsem vystřelil růži z papíru, [Gmi]\n[C7]dala sis ji do vlasů, kde hladívám tě já, [F] [A7]\n[Dmi]v tomhle smutným světě jsi má naděj na víru,\n[Ami]že nebe modrý ještě smysl má. [Dmi]\n\n[Dmi]Přines' jsem ti kytku, no co koukáš, to se má, [E7] [Gmi]\n[Ami]tak jsem asi jinej, teď to víš,\nmožná trochu zvláštní v dnešní době, no tak ať,\n[Ami]třeba z ní mou lásku vytušíš. [Dmi]\n\nMezihra: Dmi E7 Gmi Ami Dmi E7 Gmi Ami Dmi\n\nRefrén"
  },
  {
    "id": 10,
    "title": "Jdem zpátky do lesů",
    "artist": "",
    "key": "G",
    "content": "[Am7]Sedím na kolejích, které nikam nevedou, [D] [G] [C]\nkoukám na kopretinu, jak miluje se s lebedou,\nmraky vzaly slunce zase pod svou ochranu,\njen ty nejdeš, holka zlatá, kdypak já tě dostanu?\n\n[G]Z ráje, my vyhnaní z ráje, [Emi]\n[Ami7]kde není už místa, [C]prej něco se chystá, [G] [D7]\n[G]z ráje nablýskaných plesů, [Emi]\n[Ami7]jdem zpátky [C]do lesů [G]\nza nějaký čas.\n\n[C]Vlak nám včera ujel ze stanice do nebe, [D] [G]\nmálo jsi se snažil, málo šel jsi do sebe,\nšel jsi vlastní cestou, a to se zrovna nenosí,\ni pes, kterej chce přízeň, napřed svýho pána poprosí.\n\nR: 2x"
  },
  {
    "id": 11,
    "title": "Dobrák od kosti",
    "artist": "",
    "key": "D",
    "content": "[D]Má milá jak ti je, tak jak ti je? [A] [G]\nJsem ten, kdo jednou tvý tělo zakryje.\nJsem ten, kdo tě jednou oddělá.\nPotkala's zkrátka koho's neměla.\n\n[D]Je to vážně silná káva,\n[A]pláč a nebo vztek, nic už s tím nenadělás [G]\n[D]nech mě jenom hádat,\n[A]jak jsi hebká na dotek, krásná a nedospělá [G]\n\n[D]Víš, všechno má aspoň malý kaz [A] [G]\njsem ten, kdo ti jednou zlomí vaz [D] [A] [G]\nMá milá vždyť mě znáš jsem dobrák od kosti\na ty jsi ta co mi to jednou všechno odpustí\n\nR:\n[D]Má milá jak ti je, tak jak ti je? [A] [G]"
  },
  {
    "id": 12,
    "title": "Povídej",
    "artist": "",
    "key": "G",
    "content": "[G]Povídej, jestli tě má hodně rád, víc než já, [D] [G]\njestli, když večer jdeš spát, ti polibek dá,\n[Hmi]tak jako já, [C]to už je dávno, [G]tak povídej, [D]hej, [G]povídej.\n\n[G]Povídej, nechal tě být, vždyt měl tě tak rád, [D] [G]\nnebos' ho nechala jít, když šel k jiný spát,\n[Hmi]tak jako mě, [C]to už je dávno, [G]tak povídej, [D]hej, [G]povídej.\n\n[Hmi]Povídej, jestli se ti po mně stýská, [G]když večer jdeš spát, [A7] [C] [G]\njestli, když v noci se blýská, nepřestala ses bát.\n\n[G]Povídej, ne, já se nevrátím, jdi domů spát,\ntvou lásku ti vyplatím, víc nemůžu dát,\n[Hmi]jak jsem dal dřív, [C]to už je dávno, [G]tak povídej, [D]hej, [G]povídej.\n[Hmi]Povídej, [C]povídej, [G]povídej."
  },
  {
    "id": 13,
    "title": "Zatanči",
    "artist": "",
    "key": "Em",
    "content": "[Emi]Zatanči, má milá, zatanči pro mé oči, [G] [D] [Emi]\nzatanči a vetkni nůž do mých zad,\nať tvůj šat, má milá, ať tvůj šat na zemi skončí,\nať tvůj šat, má milá, rázem je sňat. [G] [D] [Emi]\n\n[Emi]Zatanči, jako se okolo ohně tančí, [G] [D] [Emi]\nzatanči jako na vodě loď,\nzatanči jako to slunce mezi pomeranči,\nzatanči, a pak ke mně pojď. [G] [D] [Emi]\n\n[Emi]Polož dlaň, má milá, polož dlaň na má prsa, [G] [D] [Emi]\npolož dlaň nestoudně na moji hruď,\nobejmi, má milá, obejmi moje bedra,\nobejmi je pevně a moji buď. [G] [D] [Emi]\n\n[Emi]Nový den než začne, má milá, nežli začne, [G] [D] [Emi]\nnový den než začne, nasyt můj hlad,\nzatanči, má milá, pro moje oči lačné,\nzatanči a já budu ti hrát. [G] [D] [Emi]"
  },
  {
    "id": 14,
    "title": "Igelit",
    "artist": "",
    "key": "G",
    "content": "[G]Ukrytý v stínu lesa, igelit, to kdyby přišel k ránu déšt, [D] [C] [G]\npod hlavou boty, nůž, tátovu bundu šitou z maskáčů,\nk ránu se mlhy zvednou a ptáci volaj': hele, lidi, svítá,\npak větvičky si nalámou na oheň, aby uvařili čaj.\n\nR: [Emi]A všichni se znaj', znaj', znaj' a bláznějí a zpívaj' [D7] [G] [C] [G]\na po cestách dál, dál, dál hledaj' normální svět.\n\n[G]Ukrytý v stínu lesa, k večeru znavený nohy skládaj', [D] [C] [G]\nkytara zpívá o tom, jak dřív bylo líp,\nta chvilka, co máš na život, ti uplyne jak od ohýnku dým.\n\nRefrén"
  },
  {
    "id": 15,
    "title": "Zabili",
    "artist": "",
    "key": "D",
    "content": "[D]Zabili zabili, chlapa z koločavy [G] [Emi] [G] [D]\nřekněte hrobaři, kde je pochovaný\n\nRef: [D]Bylo tu není tu, havrani na plotu [G]\n[D]bylo vino v sudě, teď tam voda bude [G]\n[G]není není tu [D]\n\n[D]Špatně ho zabili špatně pochovali [G] [Emi] [G] [D]\nvlci ho pojedli ptáci rozklovali\n\nRef:\n\n[D]Kráká starý havran krákat nepřestane [G] [Emi] [G] [D]\ndokud v Koločavě živý chlap zůstane\n[Emi]živý chlap zůstane [G] [D]"
  },
  {
    "id": 16,
    "title": "Bedna od whiskey",
    "artist": "",
    "key": "Am",
    "content": "[Am]Dneska už mně fóry ňák nejdou přes pysky, [C] [Am] [E]\nstojím s dlouhou kravatou na bedně vod whisky,\ntu kravatu, co nosím, mi navlík' soudce Lynč\n\n[D]Tak kopni do tý bedny, ať panstvo nečeká, [E] [A]\njsou dlouhý schody do nebe a štreka daleká\ndo nebeského baru, já sucho v krku mám,\ntak kopni do tý bedny, ať na cestu se dám.\n\n[Am]Mít tak všechny bedny vod whisky vypitý,\npostavil bych malej dům a chlastal bych tam s Bilem a s Benem.\n\n[Am]Kdyby jsi se, hochu, jen porád nechtěl rvát,\nnemusel jsi dneska na týhle bedně stát.\n\n[Am]Když jsem štípnul koně a ujel jen pár mil,\nzatracená smůla zlá, zatracenej pech,\nkdyž kůň cucá whisku jak u potoka mech.\n\nTak kopni do tý bedny!"
  },
  {
    "id": 17,
    "title": "Veď mě dál",
    "artist": "",
    "key": "G",
    "content": "[G]Někde v dálce cesty končí, každá však cíl svůj skrývá. [Emi] [D] [C] [G]\nNěkde v dálce každá má svůj cíl, ať je pár mil dlouhá nebo tisíc mil.\n\nRef. [G]Veď mě dál, cesto má, veď mě dál, vždyť i já, [D] [Emi] [C]\n[G]tam, kde končíš, chtěl bych dojít, veď mě dál cesto má. [D] [C] [G]\n\n[G]Chodim dlouho po všech cestách, všechny znám je, jen ta má mi zbývá [Emi] [D] [C] [G]\nJe jak dívky, co jsem měl tak rád, plná žaru bývá, hned zas samý chlad.\n\nRefrén\n\n[Emi]Pak na patník poslední napíšu křídou jmeno své a [D] [G] [C]\n[G]pod něj, že jsem žil hrozně rád [D]\n[Emi]Písně své co mi v kapsách zbydou, dám si bandou cvrčků [F] [C] [G]\n[D]hrát a půjdu spát, půjdu spát.\n\nRef. 2x\n|: Veď mě dál cesto má. :| [D] [G]"
  },
  {
    "id": 18,
    "title": "Husličky",
    "artist": "",
    "key": "Am",
    "content": "[G]|: Čí že ste, husličky, čie, [C] [G]\n[Ami]kdo vás tu zanechal :| [Emi] [D]\n[Ami7]na trávě poválané, [D] [G] [C]\n[Ami]u paty ořecha? [Emi] [D]\n\n[G]|: A kdože tu trávu tak zvával, [C] [G]\n[Ami]aj modré fialy :| [Emi] [D]\n[Ami7]že ste husličky samé, [D] [G] [C]\n[Ami]na světě zostaly? [Emi] [D]\n\n[G]|: A který tu muzikant usnul [C] [G]\n[Ami]a co sa mu přišlo zdát :| [Emi] [D]\n[Ami7]co sa mu v noci zdálo, [D] [G] [C]\n[Ami]že už vjec nechtěl hrát? [Emi] [D]\n\n[G]|: Zahrajte, husličky samy, [C] [G]\n[Ami]zahrajte zvesela :| [Emi] [D]\n[Ami7]až sa tá bude trápit, [D] [G] [C]\n[Ami]která ho nechtěla [Emi] [D]\n\nAmi Emi Hmi C D G"
  },
  {
    "id": 19,
    "title": "Ráda se miluje",
    "artist": "",
    "key": "Am",
    "content": "[Ami]Ráda se miluje, ráda jí, ráda si jenom tak zpívá, [G] [C] [F] [Emi] [Ami]\nvrabci se na plotě hádají, kolik že času jí zbývá.\n\n[F]Než vítr dostrká k útesu tu její legrační bárku [C] [F] [C] [E]\n[Ami]a Pámbu si ve svým notesu udělá jen další čárku.\n\nRef: (opakuje se)\n\n[F]Psáno je v nebeské režii, a to hned na první stránce,\n[Ami]že naše duše nás přežijí v jinačí tělesný schránce.\n\n[F]Úplně na konci paseky, tam, kde se ozvěna tříští,\n[Ami]sedí šnek ve snacku pro šneky - snad její podoba příští.\n\nOriginál: Capo 2, Ami G C Fmaj Emi"
  },
  {
    "id": 20,
    "title": "Jesse James",
    "artist": "",
    "key": "G",
    "content": "[G]Jesse James chlapík byl, hodně lidí vodpravil, [C] [G]\nvlaky přepadával rád. [D7]\n[G]Boháčům uměl brát, chudákům daval zas, [C] [G]\npřál bych vám abyste ho mohli znát. [D7] [G]\n\nRef. [C]Jó, Jesse ženu svou tady nechal ubohou [G]\na tři děcka říkám vám, [D7]\n[G]ale tenhle přítel hadí ten vám Jesse zradí. [C] [G]\nJá vím tenkrát v noci prask ho sám. [D7] [G]\n\n[G]Jednou vám byla noc, měsic tenkrát svítil moc,\nkdyž tu vláček zůstal stát.\nKdekdo ví že ten vlak přepad James kabrňák\nčistě sám se svým bráchou akorát.\n\nRefrén\n\n[G]Jedenkrát Jesse James sedí doma za stolem\na svým dětem vypráví\nRoberd Ford v nočních tmách připlíží se jako vrah\na on vám Jesse Jamese odpraví.\n\nRefrén"
  },
  {
    "id": 21,
    "title": "Zachraňte koně",
    "artist": "",
    "key": "Em",
    "content": "[Em]Peklo byl ráj když hořela stáj, příteli [Am7]\n[C]Věř mi, koně pláčou povídám [D] [G] [H7]\n[Em]To byla půlnoc v tom křik o pomoc\n[C]hejna kohoutů a bůhví kam [Hm] [Em]\n\nRef. [G]Zachraňte koně, křičel jsem tisíckrát [Hm] [C]\n[G]žil jsem jen pro ně, bránil je nejvíckrát [Hm] [C]\n[Am]než přišla chvíle, kdy hřívy bíle,\n[Am]procesál plamen, spálil na troud [H7]\n\n[Em]Ohrady a stáj a v plamenech kraj už nedýchal [Am7]\n[C]já viděl jak to hříbě umírá\n[Em]klisna u něj a smuteční děj se odbývá\n[C]jak tiše pláče oči přivírá [Hm] [Em]\n\nRefrén 2x\n[Em]zachraňte koně"
  },
  {
    "id": 22,
    "title": "Knock knock / Nebeská brána",
    "artist": "Bob Dylan / trad.",
    "key": "G",
    "content": "[G]Mama, take this badge off of me [D] [Ami]\nI can't use it anymore [G] [D] [C]\n[G]It's gettin' dark, too dark for me to see\nFeel like I'm knockin' on heaven's door\n\nRef. (4x) [G]Knock, knock, knockin' on heaven's door [D] [Ami/C]\n\n[G]Mama, put my guns on the ground\nI can't shoot them any more\nThat long black cloud is comin' down\nFeels like I'm knockin' on heaven's door\n\n---\n\n[G]Mámo sundej kytku z kabátu [D] [Ami]\nza chvíli mi bude k ničemu [G] [D] [C]\n[G]můj kabát a kudlu vem pro tátu\njá už stojim před branou s klíčem\n\nRef. [G]Cejtím že zaklepu na nebeskou bránu [D] [Ami/C] (3x)\n\nNeberu s sebou milý tváře, žijte si tu co se do vás vejde,\naž popíšem všechny diáře, všichni se tam za tou branou sejdem\n\nRef. [G]Všichni jednou zaklepem na nebeskou bránu [D] [Ami7] [C] (3x)"
  },
  {
    "id": 23,
    "title": "Budu všechno co si budeš přát",
    "artist": "",
    "key": "G",
    "content": "[G]Záplavou uprostřed pouště všedních dní, [G7] [C] [D] [G]\nhouslistou, co tvoje struny rozezní,\nmůžu být, když si to budeš přát. [C] [D] [G]\n\n[G]Požárem co rozpálí tě do běla, [G7] [C] [D] [G]\nzlodějem, co státní banku udělá,\nmůžu být, když si to budeš přát. [C] [D] [G]\n\nRef. [G]Bláznem co staví na poušti most [D]\na v dešti tančí pro radost. [D7] [H7] [Emi]\n[Emi]budu všechno co si budeš přát. [C] [D]\n[G]Slunečním světlem a půlnoční tmou, [D]\ntvou stopou v písku ztracenou, [D7] [H7] [Emi]\n[Emi]budu všechno co si budeš přát [C]\n[D]a ještě k tomu rád. [G]\n\n[G]Šachistou co pátým tahem dává mat, [G7] [C] [D] [G]\nsvítáním ve tmě, kde začala ses bát,\nmůžu být, když si to budeš přát. [C] [D] [G]\n\nRefrén 2x\n\n[G7]Máš to mít, když si to budeš přát. [C] [D] [G] (4x)"
  },
  {
    "id": 24,
    "title": "Panenka",
    "artist": "",
    "key": "C",
    "content": "[C]Co skrýváš za víčky a plameny svíčky, [F] [C] [F]\nsnad houř bílých holubic nebo jen žal,\ntak odplul ten prvý den smáčený krví,\nani poutovou panenku nezanechal. [C] [G] [C]\n\nRef: [C]Otevři oči, ty uspěchaná dámo uplakaná, [F] [C] [G] [F] [C] [G]\n[F]otevří oči, ta hloupá noc končí a mír je mezi náma. [C] [F] [C] [G] [C]\n\n[C]Už si oblékni šaty i řetízek zlatý\na umyj se, půjdeme na karneval,\na na bílou kůži ti napíšu tuší,\nže dámou jsi byla a zůstáváš dál.\n\nRefrén"
  },
  {
    "id": 25,
    "title": "Colorado",
    "artist": "",
    "key": "G",
    "content": "[G]Táta vždycky říkal hochu žádný strachy. [C]\nSeš kovboj v Coloradu můžeš kravy pást. [G] [D]\n[G]Já radši utratil jsem psa a všechny prachy.\nDo srdce Evropy já odjel v klidu krást. [G] [D] [G]\n\n[G]Narvaný kapsy, prsteny, řetězy zlatý, [C]\ntam kolem krku místní indiáni maj.\nA ti, co nemakaj tak jsou nejvíc bohatý.\nMusim si pohnout dokavaď tam rozdávaj. [G] [D] [G]\n\nRef. [G]Z Billa na Nováka změním si svý jméno [C]\na až tu malou zemi celou rozkradem, [G] [D]\n[G]tak se vrátím ve svý rodný Colora - do [Emi] [C]\na o tý zlatý žíle řeknu doma všem. [G] [D] [G]\n\nRefrén\nOutro: [G]O tý zlatý žíle řeknu doma všem [D] [G]"
  },
  {
    "id": 26,
    "title": "Měsíc",
    "artist": "",
    "key": "Em",
    "content": "[Emi]Děkuju ti za to, žes mi ještě zavolala, [D] [G] [C] [G] [D]\nmoje duše černá už to ani nečekala.\n[Emi]Jenže, moje drahá, je to všechno trochu na nic,\njá už jsem se rozhod, zitra budu znovu panic.\n\n[Emi]Děkuju ti za to, žes to rovnou nepoložil,\nže jsi nezapomněl, co jsi se mnou všechno prožil\n[Emi]Teďka svítí měsíc pro každýho zvlášť, mně je to líto,\njenže už je konec, však víš to.\n\n[Emi]Měsíc, [D]svítí měsíc. [G] [C] [G] [D] (4x)\n[Emi]Měsíc."
  },
  {
    "id": 27,
    "title": "Vizovice",
    "artist": "",
    "key": "G",
    "content": "[G]Když se s vinem probouzí den. [D] [G]\nJen já a to vino tady sem [C] [G] [D]\nJá včera s vínem šel jsem i spát\na to mam rád. [C]\n\n[G]Po vinu a po slivovici [D] [G]\nJako balón ja mám makovici.\nStejně si musim ale panaka dát.\nJá to mám rád. [C]\n\n[G]Tam kde leží Vizovice [D] [G]\nTam jsme přece my a slivovice.\na dobrych lidí, co mám tu čest znát.\nco je mam rád [C]\n\n[G]Tam vychazí trnky brnky [D] [G]\nV lesích jsou jak žirafy tak i srnky.\nTam ti nikdo život nebude brát,\njenom o játra se musiš bát. [G] [D] [G]\n\n[G]Touhle písní chtěl jsem jen říct [D] [G]\nže jsou místa, kde bude vám líp. [C] [G] [D]\n|: Každý má někde svoje Vizovice,\nkde jsou známí a ne pijavice. :| [G] [D] [G]"
  },
  {
    "id": 28,
    "title": "Dej mi víc své lásky",
    "artist": "",
    "key": "Am",
    "content": "[Ami]Vymyslel jsem spoustu nápadů, aů, [C]\nco podporujou hloupou náladu, aů, [Ami] [G] [E]\n[Ami]hodit klíče do kanálu, sjet po zadku holou skálu,\n[Ami]v noci chodit strašit do hradu [E] [Ami]\n\n[Ami]Dám si dvoje housle pod bradu, aů, [C]\nv bílé plachtě chodím pozadu, aů,\n[Ami]úplně melancholicky, s citem pro věc jako vždycky\n[Ami]vyrábím tu hradní záhadu, aů [E] [Ami] [G]\n\n[C]Má drahá, dej mi víc, má drahá, dej mi víc, [E]\n[Ami]má drahá, dej mi víc své lásky, aů, [F] [C] [G]\n[C]já nechci skoro nic, já nechci skoro nic, [E]\n[Ami]já chci jen pohladit tvé vlásky, aů. [F] [C] [E]\n\n[Ami]Nejlepší z těch divnejch nápadů, aů,\nmi dokonale zvednul náladu, aů,\n[Ami]natrhám ti sedmikrásky, tebe celou s tvými vlásky\n[Ami]zamknu si na sedm západů, aů [E] [Ami] [G]\n\nRefrén"
  },
  {
    "id": 29,
    "title": "Cesta",
    "artist": "",
    "key": "C",
    "content": "[C]Tou cestou, tím směrem prý bych se dávno měl dát. [G]\nKdyž sněží, jde to stěži, ale sněhy pak tají,\n[F]kus něhy ti za nehty slíbí a dají [G]\n\n[C]Víc síly se prát, na dně víc dávat než brát. [G]\nA i když se vleče a je schůdná jen v kleče,\n[F]donutí přestat se zbytečně ptát, [G]\n\nRef. [C]Jestli se blížím k cíli, kolik zbýva víry, [G]\n[Ami]kam zvou svodidla, co po tmě mi lžou? [F] [G]\n[C]Zda couvam zpátky a plýtvam řadky, [G]\n[Ami]co řvou, že už mi doma neotevřou... [F] [G]\n\n[C]Ale zpívat a hrát, kotníky líbat, a stát. [G]\nNa křídlech všech slavíků, a vlastně už ze zvyku\n[F]přestat se zbytečně ptát, [G]\n\nRef. 2x"
  },
  {
    "id": 30,
    "title": "Malování",
    "artist": "",
    "key": "Dm",
    "content": "[Dmi]Nesnaž se, znáš se, řekni mi co je jiný, [B] [C] [Dmi]\njak v kleci máš se pro nevinný\nnoci dlouhý jsou plný touhy a lásky nás dvou\n\nRef. [B]To je to tvoje malování vzdušnejch zámků, [C] [Dmi] [B] [C]\nmalování po zdech holejma rukama [Dmi] [B] [C]\ntě nezachráni, už máš na kahánku, [Dmi] [B] [C]\nza náma, na zádech, [Dmi] [B] [C]\nje to za náma, ty čteš poslední stranku, [Dmi] [B] [C]\nza náma, [Dmi] [B] [Gmi] [Ami]\nmezi náma, mi taky došel dech.\n\nRefrén\n\n[Dmi]Znáš se, řekni mi co je jiný [B] [C] [Dmi]\njak v kleci máš se pro nevinný\nnoci dlouhý jsou plny touhy a lásky nás tří."
  },
  {
    "id": 31,
    "title": "Fotr",
    "artist": "",
    "key": "A",
    "content": "[A]Jednou mi fotr povídá, zůstali jsme už sami dva, [D]\nže si chce začit taky trochu žít, [E] [A]\n[A]nech si to projít palicí a nevracej se s vopicí,\nsnaž se mě hochu trochu pochopit. [E] [A]\n\n[E]Já šel, šel dál, baby, kam mě Pánbůh zval, [A]\njá šel, šel dál, baby, a furt jen tancoval, [E] [D7]\n[A]na každý divný hranici, na policejní stanici [D]\n[E]hrál jsem jenom rock'n'roll for you. [A]\n\n[A]Přiletěl se mnou černej čáp, zobákem dělal rockin' klap [D]\na nad kolíbkou Elvis Presley stál,\nobrovskej bourák v ulici, po boku krásnou slepici\na lidí šeptaj: přijel ňákej král. [E] [A]\n\nRefrén\n...hrál jsem jenom rock'n'roll for you."
  },
  {
    "id": 32,
    "title": "Nagasaki Hirošima",
    "artist": "",
    "key": "G",
    "content": "R. [G]Tramvají dvojkou jezdival jsem - do Židenic, [D] [C] [D] [G]\nz takový lásky - většinou nezbyde nic,\n[C]z takový lásky - jsou kruhy pod očima [G] [C] [G] [D]\na dvě - spálený srdce – Nagasaki, Hirošima.\n\n[G]Jsou jistý věci, co bych tesal do kamene,\ntam, kde je láska, tam je všechno dovolené,\n[C]a tam, kde není, tam mě to nezajímá,\njó, dvě spálený srdce – Nagasaki, Hirošima.\n\n[G]Já nejsem svatej, ani ty nejsi svatá,\njablka z ráje bejvala jedovatá,\n[C]jenže! - hezky jsi hřála, když mi někdy byla zima,\njó, dvě spálený srdce – Nagasaki, Hirošima.\n\nR: a dvě spálený srdce – Nagasaki, Hirošima  3x"
  },
  {
    "id": 33,
    "title": "Amerika",
    "artist": "",
    "key": "D",
    "content": "[D]Nandej mi do hlavy tvý brouky, a Bůh nám seber beznadějl [A] [Emi] [D]\nV duši zbylo světlo z jedny holky, tak mi teď za to vynadej.\n\n[D]Zima a promarnéný touhy, do vrásek stromů padá déšt.\nZbejvaj roky asi ne moc dlouhý,\n[Emi]do vlasů mi zabroukej... pa pa pa pá [G] [D]\n\nRef: [D]pa pa pa pá, pá pa pa pá   jejé [A] [Hmi] [D]\n[D]pa pa pa pá, pá pa pa pá [C#7] [Hmi] [D]\n\n[D]Tvoje oči jenom žavý tóny, dotek slunce zapadá.\nHorkej vítr rozezní mý zvony,\n[Emi]do vlasů ti zabroukám ... pá pa pá pá [G] [D]\n\nRef. (opakuje se)\n\n[D]Na obloze křídla tažnejch ptáků, tak už na svý bráchy zavolej.\nNa tváře ti padaj slzy z mraků a Bůh nám sebral beznadějl.\n\nRef. + D, C#7, Hmi"
  },
  {
    "id": 34,
    "title": "Made in Valmez",
    "artist": "",
    "key": "D",
    "content": "[D]jako je sama skála [Gmaj7] [Emi] [A]\ntak jsem sám i já\n[D]jako je prázdná duha [Gmaj7] [Emi] [A]\ntak jsem prázdný i já\n[D]jako je zrádná voda [Gmaj7] [Emi] [A]\ntak zradím i já\n\nRef. [D]zkouším se prokopat ven - zkouší se prokopat ven!\n[Gmaj7]zkouším se prokopat ven! [Emi] [A] (opakuje se)\n\n[D]O půl třetí na náměstí ve Valašském Meziříčí [Gmaj7] [Emi] [A]\njdu co noha nohu mine, a každý sám sobě jsme stínem\nnic mi není přitom melu z posledního,\ntěžko říct o tom něco konkrétního\nstejná slova kolem stejný tváře\na každý sám sobě jsme lhářem a já už zase\n\nRefrén\nOutro: [D]zkouším se prokopat ven [Gmaj7] [Emi] [A] [D]"
  },
  {
    "id": 35,
    "title": "Nebude to taky lehké",
    "artist": "",
    "key": "Am",
    "content": "[Ami]Vraj zmenila si číslo [G]\nA do zámku nepasuje viac môj kľúč [Ami] [G] [Fmaj7]\nHlavou mi blyslo, asi chceš aby som bol už fuč.\n\n[C]Nebude to také lahké drahá [G] [F]\nMňa sa nezbaviš s tým sa lúč [C] [G] [F]\n[C]Nebude to také lahké drahá\nNemožeš ma vymeniť ako rúž [G] [F] [G] (stop)\n[Ami]Som tvoj muž\n\nMedzihra: Ami G Ami G\n\nVraj koketuješ s iným, dolámem mu kosti, nos a sny\nTak dopúšťaš sa viny, tak vrav, povedz čo máš s ním.\n\nR:\n\n[F]Predsa sme si súdený [G]\nJa nemožem žiť bez ženy [F] [G]\n[F]Ja nemožem žiť bez teba to mi ver [G] [Ami]\n[F]A v kostole pred pánom, sľubovala si nám dvom [G]\n[F]Nekonečnú lásku, vernosť, mier, mier, mier [G] [Ami]\nR:"
  },
  {
    "id": 36,
    "title": "Kdyby tady byla",
    "artist": "",
    "key": "A",
    "content": "[A]|: Kdyby tady byla taková panenka, která by mě chtěla. :| [E] [A]\n[D]|: Která by mě chtěla syna vychovala, přitom pannou byla. :| [A] [E] [A]\n\n[A]|: Kdybych já ti měla syna vychovati, přitom pannou býti. :| [E] [A]\n[D]|: Ty by jsi mě musel kolébku dělati, do dřeva netíti. :| [A] [E] [A]\n\n[A]|: Kdybych já ti musel kolébku dělati, do dřeva netíti. :| [E] [A]\n[D]|: Ty bys mi musela košiličku šíti, bez jahel a niti. :| [A] [E] [A]\n\n[A]|: Kdybych já ti měla košiličku šíti, bez jahel a niti. :| [E] [A]\n[D]|: Ty by si mě musel žebřík udělati, až k nebeské výši. :| [A] [E] [A]\n\n[A]|: Kdybych já ti musel žebřík udělati, až k nebeské výši. :| [E] [A]\n[D]|: Lezli bysme spolu, spadli bysme dolů, byl by konec všemu. :| [A] [E] [A]"
  },
  {
    "id": 37,
    "title": "Pocity",
    "artist": "",
    "key": "G",
    "content": "[G]Z posledních pocitů poskládám ještě jednou úžasnou chvíli [D] [Emi] [C]\nJe to tím, že jsi tu, možná tím, že kdysi jsme byli Ty a Já,\ndvě nahý těla, tak neříkej, že jinak si to chtěla,\ntak neříkej, neříkej, neříkej mi nic.\n\n[G]Stala ses do noci z ničeho nic moje platonická láska [D] [Emi] [C]\nunaven, bezmocný, usínám vedle Tebe, něco ve mně praská.\n\nR: [G]Jenže ty neslyšíš, jenže ty neposloucháš, [D] [Emi] [C]\nsnad ani nevidíš, nebo spíš nechceš vidět\na druhejm závidiš a v očích kapky slaný vody\nzkus změnu, uvidíš. Pak vitej do svobody\n\n[G]Jsi andělí, netušíš. Anděl, co ze strachu mu utrhali křídla.\nA až to ucítíš, zkus kašlat na pravidla.\n\nR: Jenže ty neslyšíš..."
  },
  {
    "id": 38,
    "title": "Zafůkané",
    "artist": "",
    "key": "Am",
    "content": "[Ami]Větr sněh zaněsl z hor do polí, já idu přes kopce, přes údolí, [C] [G] [Ami]\nidu k tvej dědinë zatúlanej, cestičky sněhem sú zafůkané. [C] [G] [C] [F] [C] [E] [Ami]\n\n[Ami]Zafůkané, zafůkané, kolem mňa všecko je zafůkané. [C] [G] [C] [F] [C] [Dmi] [E]\n[Ami]Zafůkané, zafůkané, kolem mňa všecko je zafůkané.\n\nMEZIHRA: Emi D G H7 Emi D G H7 Emi\n\n[Ami]Už vašu chalupu z dálky vidím, srdce sa ozvalo, bít ho slyším,\nsnáď enom pár kroků mi zostává, a budu u tvého okénka stát.\n\nR: okénko k tobě je zafůkané\n\n[Ami]Od tvého okna sa smutný vracám, v závějoch zpátky dom cestu hledám,\nspadl sněh na srdce zatúlané, aj na mé stopy - sú zafůkané.\n\nR: mé stopy k tobě sú zafůkané"
  },
  {
    "id": 39,
    "title": "Honolulu",
    "artist": "",
    "key": "G",
    "content": "[G]Letecká linka do ráje [C] [D] [C]\nk ostrovům slunné Havaje\nnabrala kurs vlastní osy\ntam holky plavky nenosí [C] [D] [G]\n\n[G]Na pláži Beach Boys čekají [C] [D] [C]\nbanány z palem padají\nna runway Boeing dosedá\na slunce pálí, to se má [C] [D] [G]\n\n[D]Honolulu, ukululu, tohle mám rád [C] [G]\nreagge, reagge, reagge\n[D]Honolulu, ukululu... [C]\n[G]hej [C] [D] [C] [G]\n\n[G]Tu náhle signál budíku [C] [D]\nvytáh' mě z pláže rovníku\nšalinou za pětikačku\njedu vorazit štípačku [C] [D] [G]\n\nRefrén"
  },
  {
    "id": 40,
    "title": "Sen",
    "artist": "",
    "key": "E",
    "content": "[E]Stíny dnů a snů se k obratníkům stáčí [A]\n[E]Ruce snů černejch se snaží zakrýt oči [A]\n[F#mi]Světlo tvý prozradí proč já vím [A] [E]\n[F#mi]S novým dnem, že se zas navrátí [A] [H]\n\n[E]Mraky se plazí, vítr je láme [A]\n[E]Stíny tvý duše rozplynou se v šeru [A]\n[F#mi]Ve vlnách opouští, po hodinách mizí [A] [E]\n[F#mi]A měsíc nový stíny vyplaší [A] [H]\n\nR: [E]Proud motýlů unáší strach\n[A]Na listy sedá hvězdnej prach\n[C#mi]Proletí ohněm a mizí stále dál [H]\n[E]Neslyšný kroky stepujou\n[A]V nebeským rytmu swingujou\n[C#mi]Že se ráno vytratí [H]\n\nR: Proud motýlů unáší strach..."
  },
  {
    "id": 41,
    "title": "Jasná zpráva",
    "artist": "",
    "key": "G",
    "content": "[G]Skončili jsme jasná zpráva,\n[Emi]proč o tebe zakopávam dál, [C] [D]\n[Ami]projít bytem já abych se bál. [C] [G]\n[G]Dík tobě se vidím zvenčí,\n[Emi]připadám si starší menší sám, [C] [D]\n[Ami]kam se kouknu, kousek tebe mám. [C] [G]\n\nRef. [Emi]Pěnu s vůní jablečnou, vyvanulý sprej, [Hmi] [Emi] [Hmi]\n[Emi]telefon, cos ustřihla mu šňůru. [G] [D]\n[Emi]knížku krásně zbytečnou, co má lživý děj,\n[Emi]píše se v ni, jak se lítá vzhůru,\n[Ami]lítá vzhůru, ve dvou vzhůru. [D]\n\n[G]Odešla's mi před usvitem,\n[Emi]mám snad bloudit vlastním bytem sám, [C] [D]\n[Ami]kam se kouknu, kousek tebe mám. [C] [G]\n\nRefrén\n\n[G]Skončili jsme jasná zpráva,\n[Emi]není komu z okna mávat víc, [C] [D]\n[Ami]jasná zpráva, rub, co nemá líc. [C] [G]"
  },
  {
    "id": 42,
    "title": "Mezi horami",
    "artist": "",
    "key": "Am",
    "content": "[Ami]Mezi horami, [G]lipka zelená. [Ami] [C] [G] [C]\n|: Zabili Janka, Janička, Janka, miesto jeleňa. :| [C] [G] [Ami] [Emi] [Ami]\n\n[Ami]|: Keď ho zabili, zamordovali. :|  |: Na jeho hrobě, kříž postavili. :|\n\n[Ami]|: Ej křížu, křížu, ukřižovaný. :|  |: Zde leží Janík, zamordovaný. :|\n\n[Ami]|: Tu šla Anička, plakat Janička. :|  |: Hned na hrob padla a viac nevstala. :|\n\n---\ncap.3\n[Dmi]Mezi horami, [C]lipka zelená. (další sloky v Dmi)"
  },
  {
    "id": 43,
    "title": "Sbohem galánečko",
    "artist": "",
    "key": "G",
    "content": "[G]Sbohem galánečko já už musím jiti [Emi] [Ami] [D] [G] [A7]\nsbohem galánečko já už musím jiti [D] [Hmi] [Emi] [A] [D]\n|: Kyselé vínečko, kyselé vínečko [Ami] [D] [G] [Ami] [D]\n[G]Podalas mně k pití :| [Ami] [D] [G]\n\n[G]Sbohem galánečko ozlučme sa v pánu\n|: Kyselé vínečko, kyselé vínečko\n[G]Podalas mně v džbánu :| [Ami] [D] [G]\n\n[G]Ač bylo kyselé přeca sem sa opil\n|: Ešte včil sa stydím, ešte včil sa stydím\n[G]Co jsem všechno tropil :| [Ami] [D] [G]\n\n[G]Ale sa nehněvám žes mňa ošidila\n|: To ta moja žízeň, to ta moja žízeň\n[G]Ta to zavinila :| [Ami] [D] [G]"
  }
];
</script>

<script>
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// STORAGE KEYS
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
const STORAGE_KEY = 'zpevnik_v1';
const STORAGE_SEEDED = 'zpevnik_seeded_v1';
const STORAGE_NL = 'zpevnik_nl_v1';
const STORAGE_THEME = 'zp_theme';

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// SONGS â load from localStorage, seed DEFAULTS only once
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
function loadSongs() {
  try {
    const r = localStorage.getItem(STORAGE_KEY);
    if (r) return JSON.parse(r);
  } catch(e) {}
  return null;
}
function persist() { try { localStorage.setItem(STORAGE_KEY, JSON.stringify(songs)); } catch(e) {} }

// Seed defaults only if never seeded before
let songs = loadSongs();
if (!songs) {
  // Load DEFAULTS from inline data â only runs ONCE ever
  songs = (typeof DEFAULTS !== 'undefined') ? DEFAULTS.map(s=>({...s})) : [];
  persist();
  try { localStorage.setItem(STORAGE_SEEDED, '1'); } catch(e) {}
}

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// STATE
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
let cur = null, showChords = true, fontSize = 17;
let scrolling = false, scrollLevel = 2, raf = null;
const SPEEDS = [0.2, 0.5, 1.0, 1.8, 3.0];
let isDark = false;


// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// THEME
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
function applyTheme() {
  document.body.classList.toggle('dark', isDark);
  document.getElementById('theme-btn').textContent = isDark ? 'âï¸' : 'ð';
}
function toggleTheme() {
  isDark = !isDark;
  applyTheme();
  try { localStorage.setItem(STORAGE_THEME, isDark ? '1' : '0'); } catch(e) {}
}
(()=>{ try { if (localStorage.getItem(STORAGE_THEME)==='1') isDark=true; } catch(e){} applyTheme(); })();

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// NAVIGATION
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
function show(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
function enterApp() {
  show('screen-home');
  renderList();
}
function showHome() { stopScroll(); if(selectedWrap){selectedWrap.classList.remove("selected");selectedWrap=null;} show('screen-home'); renderList(); }
function showAdd() {
  ['f-title','f-artist','f-key','f-content'].forEach(id => document.getElementById(id).value = '');
  show('screen-add');
  setTimeout(() => document.getElementById('f-title').focus(), 150);
}
function openSong(id) {
  cur = songs.find(s => s.id === id);
  if (!cur) return;
  document.getElementById('v-title').textContent = cur.title;
  document.getElementById('v-artist').textContent = cur.artist || '';
  stopScroll();
  const sc = document.getElementById('sc-toggle');
  sc.textContent = 'â¶ Scroll'; sc.classList.remove('on');
  renderSong();
  show('screen-song');
  document.getElementById('song-body').scrollTop = 0;
  const eb = document.getElementById('edit-btn');
  if (eb) eb.style.display = isAdmin ? '' : 'none';
}
function showEdit() {
  if (!cur) return;
  document.getElementById('e-title').value = cur.title;
  document.getElementById('e-artist').value = cur.artist || '';
  document.getElementById('e-key').value = cur.key || '';
  document.getElementById('e-content').value = cur.content;
  show('screen-edit');
}
function cancelEdit() { if (cur) openSong(cur.id); else showHome(); }

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// RENDER LIST
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
function esc(s) { return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

function renderList() {
  const q = (document.getElementById('srch-inp').value || '').trim().toLowerCase();
  let f;
  if (!q) {
    f = songs.map(s => ({song: s, snippet: null}));
  } else {
    f = songs.reduce((acc, s) => {
      const inTitle  = s.title.toLowerCase().includes(q);
      const inArtist = (s.artist||'').toLowerCase().includes(q);
      const inContent = s.content.toLowerCase().includes(q);
      if (!inTitle && !inArtist && !inContent) return acc;
      let snippet = null;
      if (!inTitle && !inArtist && inContent) {
        // Find context around match in content (strip chord brackets)
        const plain = s.content.replace(/\[[^\]]*\]/g, '');
        const idx = plain.toLowerCase().indexOf(q);
        if (idx !== -1) {
          const start = Math.max(0, idx - 30);
          const end = Math.min(plain.length, idx + q.length + 30);
          const raw = plain.slice(start, end).replace(/\n/g, ' ').trim();
          // Highlight match
          const re = new RegExp('(' + q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&') + ')', 'gi');
          snippet = (start > 0 ? 'â¦' : '') + raw.replace(re, '<mark>$1</mark>') + (end < plain.length ? 'â¦' : '');
        }
      }
      acc.push({song: s, snippet});
      return acc;
    }, []);
  }
  const n = f.length;
  document.getElementById('cnt').textContent = n===0 ? 'Å½Ã¡dnÃ© vÃ½sledky' : n===1 ? '1 pÃ­seÅ' : n<5 ? n+' pÃ­snÄ' : n+' pÃ­snÃ­';
  const el = document.getElementById('list');
  if (!f.length) { el.innerHTML = '<div class="empty">Nic nenalezeno ð</div>'; return; }
  el.innerHTML = f.map(({song: s, snippet}) => `
    <div class="card" onclick="openSong(${s.id})">
      <div style="flex:1;min-width:0">
        <div class="card-t">${esc(s.title)}</div>
        <div class="card-a">${esc(s.artist || 'NeznÃ¡mÃ½')}</div>
        ${snippet ? `<div class="card-snippet">${snippet}</div>` : ''}
      </div>
      <div class="card-r">
        ${s.key ? `<span class="kbdg">${esc(s.key)}</span>` : ''}
        ${isAdmin ? `<button class="delbtn" onclick="event.stopPropagation();deleteSong(${s.id})">ð</button>` : ''}
      </div>
    </div>`).join('');
}

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// RENDER SONG with clickable chords
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
function renderSong() {
  if (!cur) return;
  const body = document.getElementById('song-body');
  body.style.fontSize = fontSize + 'px';
  const lines = cur.content.split('\n');
  body.innerHTML = lines.map((line, li) => {
    if (!line.trim()) return '<div class="blank"></div>';
    const parts = [];
    let i = 0, ci = 0;
    while (i < line.length) {
      const ob = line.indexOf('[', i);
      if (ob === -1) { parts.push({type:'text', val:line.slice(i)}); break; }
      if (ob > i) parts.push({type:'text', val:line.slice(i, ob)});
      const cb = line.indexOf(']', ob);
      if (cb === -1) { parts.push({type:'text', val:line.slice(ob)}); break; }
      parts.push({type:'chord', val:line.slice(ob+1, cb), li, ci: ci++});
      i = cb + 1;
    }
    const html = parts.map(p => {
      if (p.type === 'chord') {
        if (!showChords) return '';
        return `<span class="ch-wrap" data-li="${p.li}" data-ci="${p.ci}">` +
          `<span class="ch-move-bar">` +
          `<button class="ch-mv-btn" onpointerdown="event.stopPropagation();mvChord(${p.li},${p.ci},-1)">â</button>` +
          `<button class="ch-mv-btn" onpointerdown="event.stopPropagation();mvChord(${p.li},${p.ci},1)">â</button>` +
          `</span>` +
          `<span class="ch" onclick="selectChordWrap(this.parentNode)">${esc(p.val)}</span>` +
          `</span>`;
      }
      return `<span class="lyr">${esc(p.val)}</span>`;
    }).join('');
    return `<div class="line">${html}</div>`;
  }).join('');
}

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// CHORD MOVE â popup toolbar on chord
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
let selectedWrap = null;

function selectChordWrap(wrap) {
  if (selectedWrap && selectedWrap !== wrap) {
    selectedWrap.classList.remove('selected');
  }
  if (selectedWrap === wrap) {
    wrap.classList.remove('selected');
    selectedWrap = null;
    return;
  }
  selectedWrap = wrap;
  wrap.classList.add('selected');
}

// Close popup when tapping elsewhere
document.getElementById('song-body').addEventListener('pointerdown', e => {
  if (!selectedWrap) return;
  if (!selectedWrap.contains(e.target)) {
    selectedWrap.classList.remove('selected');
    selectedWrap = null;
  }
});

function tokenizeLine(line) {
  const tokens = [];
  let i = 0;
  while (i < line.length) {
    const ob = line.indexOf('[', i);
    if (ob === -1) { tokens.push({type:'text', val:line.slice(i)}); break; }
    if (ob > i) tokens.push({type:'text', val:line.slice(i, ob)});
    const cb = line.indexOf(']', ob);
    if (cb === -1) { tokens.push({type:'text', val:line.slice(ob)}); break; }
    tokens.push({type:'chord', val:line.slice(ob+1, cb)});
    i = cb + 1;
  }
  return tokens;
}
function tokensToLine(tokens) {
  return tokens.map(t => t.type === 'chord' ? '['+t.val+']' : t.val).join('');
}

function mvChord(li, ci, dir) {
  if (!cur) return;
  const lines = cur.content.split('\n');
  const tokens = tokenizeLine(lines[li]);

  // Find target chord token index
  let chordCount = 0, tokenIdx = -1;
  for (let t = 0; t < tokens.length; t++) {
    if (tokens[t].type === 'chord') {
      if (chordCount === ci) { tokenIdx = t; break; }
      chordCount++;
    }
  }
  if (tokenIdx === -1) return;

  let newLi = li, newCi = ci;

  if (dir === -1) {
    // Try to move left within this line
    const prev = tokenIdx > 0 && tokens[tokenIdx-1].type === 'text' ? tokens[tokenIdx-1] : null;
    if (prev && prev.val.length > 0) {
      // Normal move left
      const ch = prev.val[prev.val.length - 1];
      prev.val = prev.val.slice(0, -1);
      const next = tokens[tokenIdx+1];
      if (next && next.type === 'text') next.val = ch + next.val;
      else tokens.splice(tokenIdx+1, 0, {type:'text', val:ch});
      lines[li] = tokensToLine(tokens);
    } else if (li > 0) {
      // At start of line â move chord to END of previous line
      tokens.splice(tokenIdx, 1); // remove chord from current line
      lines[li] = tokensToLine(tokens);
      // Rebuild chord count for new position
      const prevTokens = tokenizeLine(lines[li-1]);
      // Count chords in prev line to get new ci
      newCi = prevTokens.filter(t => t.type === 'chord').length;
      prevTokens.push({type:'chord', val: tokenizeLine(lines[li]+'')[0]?.val || ''});
      // Actually: extract the chord value from original tokens
      const chordVal = tokenizeLine(cur.content.split('\n')[li])[tokenIdx]?.val;
      // Re-extract from ORIGINAL since we already modified
      // Use a cleaner approach: work on strings
      const origLine = cur.content.split('\n')[li];
      const origTokens = tokenizeLine(origLine);
      let cc2 = 0; let chordV = '';
      for (const t of origTokens) { if(t.type==='chord'){if(cc2===ci){chordV=t.val;break;}cc2++;} }
      // Rebuild current line without the chord (insert its text around into surrounding)
      const cleanTokens = tokenizeLine(origLine);
      let cIdx2 = -1, cc3 = 0;
      for(let t=0;t<cleanTokens.length;t++){if(cleanTokens[t].type==='chord'){if(cc3===ci){cIdx2=t;break;}cc3++;}}
      // Merge surrounding text and remove chord
      if (cIdx2 !== -1) {
        const before = cIdx2 > 0 && cleanTokens[cIdx2-1].type==='text' ? cleanTokens[cIdx2-1].val : '';
        const after = cIdx2 < cleanTokens.length-1 && cleanTokens[cIdx2+1].type==='text' ? cleanTokens[cIdx2+1].val : '';
        const merged = {type:'text', val: before + after};
        const newTokens = cleanTokens.filter((_,idx)=>idx!==cIdx2);
        // merge adjacent texts
        if (cIdx2 > 0 && newTokens[cIdx2-1]?.type==='text' && newTokens[cIdx2]?.type==='text') {
          newTokens[cIdx2-1].val += newTokens[cIdx2].val;
          newTokens.splice(cIdx2, 1);
        }
        lines[li] = tokensToLine(newTokens);
      }
      // Append chord to end of prev line
      newLi = li - 1;
      newCi = tokenizeLine(lines[li-1]).filter(t=>t.type==='chord').length;
      lines[li-1] = lines[li-1] + '[' + chordV + ']';
    } else {
      return; // Can't move further left
    }
  } else {
    // Try to move right within this line
    const next = tokenIdx < tokens.length-1 && tokens[tokenIdx+1].type === 'text' ? tokens[tokenIdx+1] : null;
    if (next && next.val.length > 0) {
      // Normal move right
      const ch = next.val[0];
      next.val = next.val.slice(1);
      const prev = tokens[tokenIdx-1];
      if (prev && prev.type === 'text') prev.val = prev.val + ch;
      else tokens.splice(tokenIdx, 0, {type:'text', val:ch});
      lines[li] = tokensToLine(tokens);
    } else if (li < lines.length - 1) {
      // At end of line â move chord to START of next line
      const origLine = cur.content.split('\n')[li];
      const origTokens = tokenizeLine(origLine);
      let cc2 = 0; let chordV = '';
      for (const t of origTokens) { if(t.type==='chord'){if(cc2===ci){chordV=t.val;break;}cc2++;} }
      // Remove chord from current line (merge surrounding text)
      let cIdx2 = -1, cc3 = 0;
      for(let t=0;t<origTokens.length;t++){if(origTokens[t].type==='chord'){if(cc3===ci){cIdx2=t;break;}cc3++;}}
      if (cIdx2 !== -1) {
        const newTokens = [...origTokens];
        if (cIdx2 > 0 && newTokens[cIdx2-1]?.type==='text' && cIdx2 < newTokens.length-1 && newTokens[cIdx2+1]?.type==='text') {
          newTokens[cIdx2-1].val += newTokens[cIdx2+1].val;
          newTokens.splice(cIdx2, 2);
        } else {
          newTokens.splice(cIdx2, 1);
          if (cIdx2 > 0 && newTokens[cIdx2-1]?.type==='text' && newTokens[cIdx2]?.type==='text') {
            newTokens[cIdx2-1].val += newTokens[cIdx2].val;
            newTokens.splice(cIdx2, 1);
          }
        }
        lines[li] = tokensToLine(newTokens);
      }
      // Prepend chord to start of next line
      newLi = li + 1;
      newCi = 0;
      lines[li+1] = '[' + chordV + ']' + lines[li+1];
    } else {
      return; // Can't move further right
    }
  }

  cur.content = lines.join('\n');
  persist();
  renderSong();
  setTimeout(() => {
    const w = document.querySelector(`.ch-wrap[data-li="${newLi}"][data-ci="${newCi}"]`);
    if (w) { selectedWrap = w; w.classList.add('selected'); }
  }, 0);
}

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// TRANSPOSE
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
const CHROMATIC = ['C','C#','D','D#','E','F','F#','G','G#','A','A#','B'];
const ENHARMONIC = {'Db':'C#','Eb':'D#','Gb':'F#','Ab':'G#','Bb':'A#'};

function transposeNote(note, steps) {
  const n = ENHARMONIC[note] || note;
  const idx = CHROMATIC.indexOf(n);
  if (idx === -1) return note; // unknown, leave it
  return CHROMATIC[(idx + steps + 12) % 12];
}

function transposeChord(chord, steps) {
  // Match root note (with optional #/b) + rest (m, maj7, sus, etc.)
  const m = chord.match(/^([A-G][#b]?)(.*)/);
  if (!m) return chord;
  const newRoot = transposeNote(m[1], steps);
  // Also transpose bass note if present e.g. Am/E
  const rest = m[2].replace(/\/([A-G][#b]?)/, (_, bass) => '/' + transposeNote(bass, steps));
  return newRoot + rest;
}

function transposeAll(steps) {
  if (!cur) return;
  cur.content = cur.content.replace(/\[([^\]]+)\]/g, (_, chord) => {
    return '[' + transposeChord(chord, steps) + ']';
  });
  persist();
  renderSong();
}

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// SONG CONTROLS
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
function toggleChords() {
  showChords = !showChords;
  const b = document.getElementById('chord-btn');
  b.textContent = showChords ? 'Akordy â' : 'Akordy';
  b.classList.toggle('on', showChords);
  renderSong();
}
function changeFontSize(d) {
  fontSize = Math.max(12, Math.min(28, fontSize+d));
  if (cur) document.getElementById('song-body').style.fontSize = fontSize+'px';
}

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// AUTOSCROLL
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
function toggleScroll() {
  const b = document.getElementById('sc-toggle');
  if (scrolling) { stopScroll(); b.textContent='â¶ Scroll'; b.classList.remove('on'); }
  else { startScroll(); b.textContent='â¸ Scroll'; b.classList.add('on'); }
}
function startScroll() {
  scrolling = true;
  const el = document.getElementById('song-body');
  let acc = 0;
  function step() {
    if (!scrolling) return;
    acc += SPEEDS[scrollLevel];
    if (acc >= 1) { const px=Math.floor(acc); el.scrollTop+=px; acc-=px; }
    if (el.scrollTop + el.clientHeight >= el.scrollHeight - 2) {
      stopScroll();
      document.getElementById('sc-toggle').textContent='â¶ Scroll';
      document.getElementById('sc-toggle').classList.remove('on');
      return;
    }
    raf = requestAnimationFrame(step);
  }
  raf = requestAnimationFrame(step);
}
function stopScroll() { scrolling=false; if(raf){cancelAnimationFrame(raf);raf=null;} }
function changeSpeed(d) {
  scrollLevel = Math.max(0, Math.min(4, scrollLevel+d));
  document.getElementById('spdlbl').textContent = ['Ã1','Ã2','Ã3','Ã4','Ã5'][scrollLevel];
}

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// SAVE / EDIT SONG
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
function saveSong() {
  const t = document.getElementById('f-title').value.trim();
  const c = document.getElementById('f-content').value.trim();
  if (!t||!c) { alert('VyplÅ nÃ¡zev a text!'); return; }
  const id = Date.now();
  songs.unshift({id, title:t, artist:document.getElementById('f-artist').value.trim(), key:document.getElementById('f-key').value.trim(), content:c});
  persist(); showHome();
}
function saveEdit() {
  const t = document.getElementById('e-title').value.trim();
  const c = document.getElementById('e-content').value.trim();
  if (!t||!c) { alert('VyplÅ nÃ¡zev a text!'); return; }
  const idx = songs.findIndex(s => s.id === cur.id);
  if (idx === -1) return;

  const newKey = document.getElementById('e-key').value.trim();
  const oldKey = cur.key || '';
  let newContent = c;

  // Auto-transpose if key changed and both keys are valid notes
  if (newKey && oldKey && newKey !== oldKey) {
    const oldRoot = (ENHARMONIC[oldKey] || oldKey).toUpperCase();
    const newRoot = (ENHARMONIC[newKey] || newKey).toUpperCase();
    const oldIdx = CHROMATIC.indexOf(oldRoot);
    const newIdx = CHROMATIC.indexOf(newRoot);
    if (oldIdx !== -1 && newIdx !== -1) {
      const steps = (newIdx - oldIdx + 12) % 12;
      if (steps !== 0) {
        newContent = c.replace(/\[([^\]]+)\]/g, (_, chord) => '[' + transposeChord(chord, steps) + ']');
      }
    }
  }

  songs[idx] = {...songs[idx], title:t, artist:document.getElementById('e-artist').value.trim(), key:newKey, content:newContent};
  cur = songs[idx];
  persist();
  openSong(cur.id);
}

function deleteSong(id) {
  const s = songs.find(s => s.id === id);
  if (!s) return;
  if (!confirm(`Smazat pÃ­seÅ "${s.title}"?`)) return;
  songs = songs.filter(s => s.id !== id);
  persist();
  renderList();
}

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// NÃPOJOVÃ LÃSTEK
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
let drinks = [];
function loadDrinks() {
  try { const r = localStorage.getItem(STORAGE_NL); if(r) drinks=JSON.parse(r); } catch(e) {}
}
function persistDrinks() { try { localStorage.setItem(STORAGE_NL, JSON.stringify(drinks)); } catch(e) {} }
loadDrinks();

function openNL() {
  document.getElementById('nl-overlay').classList.add('open');
  document.getElementById('nl-panel').classList.add('open');
  renderDrinks();
  scheduleDrinkTimer();
}
function closeNL() {
  document.getElementById('nl-overlay').classList.remove('open');
  document.getElementById('nl-panel').classList.remove('open');
}

function tally(n) {
  // Czech tally marks: groups of 5 as IIII with diagonal
  if (n === 0) return '';
  let s = '';
  const full = Math.floor(n/5);
  const rem = n%5;
  for (let i=0;i<full;i++) s += 'ð¸ '; // or just use text
  // Use simple I marks
  s = '';
  for (let i=0;i<full;i++) s += 'IIIII ';
  for (let i=0;i<rem;i++) s += 'I';
  return s.trim();
}

function timeAgo(ts) {
  if (!ts) return '';
  const mins = Math.floor((Date.now() - ts) / 60000);
  if (mins < 1) return 'PrÃ¡vÄ teÄ';
  if (mins === 1) return 'PÅed 1 minutou';
  if (mins < 5) return `PÅed ${mins} minutami`;
  if (mins < 60) return `PÅed ${mins} min`;
  const hrs = Math.floor(mins / 60);
  const rem = mins % 60;
  if (rem === 0) return `PÅed ${hrs} hod`;
  return `PÅed ${hrs} hod ${rem} min`;
}

function renderDrinks() {
  const el = document.getElementById('nl-body');
  if (!drinks.length) {
    el.innerHTML = '<div class="nl-empty">Å½Ã¡dnÃ© nÃ¡poje.<br>PÅidej prvnÃ­! ðº</div>';
    document.getElementById('nl-total').style.display = 'none';
    return;
  }
  el.innerHTML = drinks.map((d,i) => `
    <div class="nl-item">
      <div style="flex:1;min-width:0">
        <div class="nl-item-name">${esc(d.name)}${d.price ? `<span style="color:var(--text3);font-size:12px;font-weight:500;margin-left:6px">${d.price} KÄ/ks</span>` : ''}</div>
        ${d.lastAt ? `<div class="nl-time">${timeAgo(d.lastAt)}</div>` : ''}
        <div class="nl-tally">${tally(d.count)}</div>
        ${d.price && d.count ? `<div style="font-size:12px;color:var(--accent);font-weight:700">${d.count * d.price} KÄ</div>` : ''}
      </div>
      <div style="display:flex;align-items:center;gap:4px;margin-left:8px">
        <button class="nl-btn" onclick="changeDrink(${i},-1)">â</button>
        <span class="nl-count">${d.count}</span>
        <button class="nl-btn plus" onclick="changeDrink(${i},1)">+</button>
        <button class="nl-delbtn" onclick="deleteDrink(${i})">ð</button>
      </div>
    </div>`).join('');
  const total = drinks.reduce((sum, d) => sum + (d.price ? d.count * d.price : 0), 0);
  const totalEl = document.getElementById('nl-total');
  const hasPrices = drinks.some(d => d.price);
  if (hasPrices) {
    totalEl.textContent = `CelkovÃ¡ Ãºtrata: ${total} KÄ`;
    totalEl.style.display = '';
  } else {
    totalEl.style.display = 'none';
  }
}

function changeDrink(i, d) {
  drinks[i].count = Math.max(0, drinks[i].count + d);
  if (d > 0) drinks[i].lastAt = Date.now();
  if (drinks[i].count === 0) delete drinks[i].lastAt;
  persistDrinks();
  renderDrinks();
  scheduleDrinkTimer();
}
function deleteDrink(i) {
  if (!confirm('Smazat nÃ¡poj?')) return;
  drinks.splice(i,1);
  persistDrinks();
  renderDrinks();
}
function resetAll() {
  if (!confirm('Vynulovat vÅ¡echny ÄÃ¡rky?')) return;
  drinks.forEach(d => { d.count=0; delete d.lastAt; });
  persistDrinks();
  renderDrinks();
}

// Live timer â refresh time labels every 30s while NL panel is open
let drinkTimer = null;
function scheduleDrinkTimer() {
  if (drinkTimer) return;
  drinkTimer = setInterval(() => {
    if (document.getElementById('nl-panel').classList.contains('open')) {
      renderDrinks();
    } else {
      clearInterval(drinkTimer);
      drinkTimer = null;
    }
  }, 30000);
}

function quickDrink(name) {
  if (drinks.find(d => d.name === name)) {
    // NÃ¡poj uÅ¾ existuje â jen zavÅi modal
    closeDrinkModal();
    return;
  }
  // NÃ¡poj neexistuje â pÅedvyplÅ nÃ¡zev a nech zadat cenu
  document.getElementById('drink-inp').value = name;
  document.getElementById('drink-price').value = '';
  document.getElementById('modal-divider-or').style.display = 'none';
  setTimeout(() => document.getElementById('drink-price').focus(), 100);
}
function showAddDrink() {
  document.getElementById('drink-inp').value = '';
  document.getElementById('drink-price').value = '';
  document.getElementById('modal-divider-or').style.display = '';
  document.getElementById('drink-overlay').classList.add('open');
  document.getElementById('drink-modal').classList.add('open');
  setTimeout(() => document.getElementById('drink-inp').focus(), 100);
}
function closeDrinkModal() {
  document.getElementById('drink-overlay').classList.remove('open');
  document.getElementById('drink-modal').classList.remove('open');
}
function addDrink() {
  const name = document.getElementById('drink-inp').value.trim();
  if (!name) return;
  const priceRaw = parseInt(document.getElementById('drink-price').value, 10);
  const price = (!isNaN(priceRaw) && priceRaw > 0) ? priceRaw : undefined;
  drinks.push({name, count:0, price});
  persistDrinks();
  closeDrinkModal();
  renderDrinks();
}
document.getElementById('drink-inp').addEventListener('keydown', e => {
  if (e.key === 'Enter') addDrink();
});

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// ADMIN AUTH
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
const ADMIN_PWD = 'Zpevnik1.!:::';
let isAdmin = false;

function logoClick() {
  if (isAdmin) {
    if (confirm('Jsi pÅihlÃ¡Å¡en jako admin. ChceÅ¡ se odhlÃ¡sit?')) {
      isAdmin = false;
      applyAdminUI();
    }
    return;
  }
  openAdminModal();
}
function openAdminModal() {
  document.getElementById('admin-modal-wrap').style.display = 'flex';
  document.getElementById('admin-pwd').value = '';
  document.getElementById('admin-err').textContent = '';
  setTimeout(() => document.getElementById('admin-pwd').focus(), 100);
}
function closeAdminModal() {
  document.getElementById('admin-modal-wrap').style.display = 'none';
}
function doAdminLogin() {
  const pwd = document.getElementById('admin-pwd').value;
  if (pwd === ADMIN_PWD) {
    isAdmin = true;
    closeAdminModal();
    applyAdminUI();
  } else {
    document.getElementById('admin-err').textContent = 'â Å patnÃ© heslo';
    document.getElementById('admin-pwd').value = '';
    document.getElementById('admin-pwd').focus();
  }
}
document.getElementById('admin-pwd').addEventListener('keydown', e => {
  if (e.key === 'Enter') doAdminLogin();
});
function applyAdminUI() {
  document.getElementById('add-btn').style.display = isAdmin ? '' : 'none';
  document.getElementById('update-btn').style.display = isAdmin ? '' : 'none';
  document.getElementById('admin-badge').style.display = isAdmin ? '' : 'none';
  const eb = document.getElementById('edit-btn');
  if (eb) eb.style.display = isAdmin ? '' : 'none';
  renderList();
}

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// GITHUB UPDATE
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
const GH_TOKEN = '';
const GH_REPO = 'pastikaalois-cloud/Zpevnik';
const GH_FILE = 'index.html';
const GH_BRANCH = 'main';

function showGithubUpdate() {
  document.getElementById('gh-modal-wrap').style.display = 'flex';
  document.getElementById('gh-status').textContent = '';
  document.getElementById('gh-status').className = 'gh-status';
  document.getElementById('gh-confirm-btn').disabled = false;
  document.getElementById('gh-confirm-btn').textContent = 'UloÅ¾it na GitHub';
  document.getElementById('gh-token-inp').value = '';
  setTimeout(() => document.getElementById('gh-token-inp').focus(), 100);
}
function closeGhModal() {
  document.getElementById('gh-modal-wrap').style.display = 'none';
  document.getElementById('gh-token-inp').value = '';
}
async function doGithubUpdate() {
  const btn = document.getElementById('gh-confirm-btn');
  const status = document.getElementById('gh-status');
  const token = document.getElementById('gh-token-inp').value.trim();
  if (!token) {
    status.textContent = 'â Zadej GitHub token!';
    status.className = 'gh-status err';
    return;
  }
  btn.disabled = true;
  btn.textContent = 'â³ NahrÃ¡vÃ¡mâ¦';
  status.textContent = 'NaÄÃ­tÃ¡m soubor z GitHubuâ¦';
  status.className = 'gh-status';
  try {
    const getResp = await fetch(`https://api.github.com/repos/${GH_REPO}/contents/${GH_FILE}?ref=${GH_BRANCH}`, {
      headers: { 'Authorization': `token ${token}`, 'Accept': 'application/vnd.github.v3+json' }
    });
    if (!getResp.ok) throw new Error('Chyba naÄtenÃ­: ' + getResp.status);
    const fileData = await getResp.json();
    const sha = fileData.sha;
    const currentContent = atob(fileData.content.replace(/\n/g,''));
    status.textContent = 'Aktualizuji pÃ­snÄâ¦';
    const newDefaults = JSON.stringify(songs, null, 2).replace(/</g,'\\u003c').replace(/>/g,'\\u003e');
    const newContent = currentContent.replace(
      /const DEFAULTS = \[[\s\S]*?\];\s*\n<\/script>/,
      `const DEFAULTS = ${newDefaults};\n<\/script>`
    );
    if (newContent === currentContent) throw new Error('NepodaÅilo se najÃ­t sekci DEFAULTS.');
    const encoded = btoa(unescape(encodeURIComponent(newContent)));
    status.textContent = 'NahrÃ¡vÃ¡m na GitHubâ¦';
    const putResp = await fetch(`https://api.github.com/repos/${GH_REPO}/contents/${GH_FILE}`, {
      method: 'PUT',
      headers: {
        'Authorization': `token ${token}`,
        'Accept': 'application/vnd.github.v3+json',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        message: `ZpÄvnÃ­k: aktualizace pÃ­snÃ­ (${new Date().toLocaleDateString('cs-CZ')})`,
        content: encoded,
        sha,
        branch: GH_BRANCH
      })
    });
    if (!putResp.ok) { const err = await putResp.json(); throw new Error('GitHub: ' + (err.message || putResp.status)); }
    status.textContent = 'â Hotovo! Za 1â2 min uvidÃ­ zmÄny vÅ¡ichni.';
    status.className = 'gh-status ok';
    btn.textContent = 'â UloÅ¾eno';
  } catch(e) {
    status.textContent = 'â ' + e.message;
    status.className = 'gh-status err';
    btn.disabled = false;
    btn.textContent = 'UloÅ¾it na GitHub';
  }
}

// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
// INIT
// ââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
renderList();
</script>
</body>
</html>
